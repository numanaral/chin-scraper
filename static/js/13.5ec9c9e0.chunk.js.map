{"version":3,"sources":["components/ContainerWithCenteredItems/types.js","components/ContainerWithCenteredItems/ContainerWithCenteredItems.js","components/Spacer/StyledWrapper.js","components/Spacer/Spacer.js","components/Spacer/types.js","utils/index.js","store/firebase/hooks/useSearchQueries.js","utils/chinese.js","api/rest.js","utils/speech.js","hooks/usePrevious.js","components/SearchForm/StyledContainer.js","components/SearchForm/SearchForm.js","components/SearchForm/types.js","components/TranslationResult/types.js","components/TranslationResult/ColoredPaper.js","components/TranslationResult/TranslationResult.js","api/translateApi.js","containers/Learn/utils.js","containers/Learn/CardGrid/Lazy.js","containers/Learn/Body.js","containers/Learn/Learn.js","routes/pages/Learn.js"],"names":["node","isRequired","bool","StyledGrid","styled","Grid","$horizontal","$vertical","ContainerWithCenteredItems","children","horizontal","vertical","rest","defaultProps","StyledWrapper","span","theme","$direction","$spacing","spacing","Spacer","direction","numberOrString","parseInt","firstCapital","s","toUpperCase","slice","pascalToSentence","str","replace","trim","noop","useSearchQueries","ref","useFirestore","collection","useFirestoreCollectionData","orderBy","add","query","devOrAnalyticsIsDisabled","createdOn","Date","REGEX_STRIP_NON_CHINESE_CHARS","REGEX_STRIP_NON_CHINESE_AND_NON_SET_PUNCTUATION_CHARS","TONE_MAP","ā","á","ǎ","à","ō","ó","ǒ","ò","ē","é","ě","è","ī","í","ǐ","ì","ū","ú","ǔ","ù","ü","ǖ","ǘ","ǚ","ǜ","ń","ň","stripNonChineseChars","text","stripNonChineseAndNonSetPunctionationChars","removeTones","pinyin","match","post","url","body","instance","axios","get","params","put","remove","delete","parse","res","a","data","serverInstance","create","baseURL","process","REACT_APP_SERVER_URI","server","props","HAN_TRAINER_PRO_PREFIX","HAN_TRAINER_PRO_POSTFIX","synth","window","speechSynthesis","utterance","SpeechSynthesisUtterance","pitch","rate","PINYIN_JS_URL","PINYIN_JS_DICTIONARY_URL","markToNumberForHanTrainerPro","speak","speaking","cancel","voice","getVoices","find","v","lang","importPinyinJsIfNeeded","pinyin_dict_withtone","headers","accept","pinyinUtil","eval","trySpeakNative","hanzi","_pinyin","getPinyin","numberedPinyin","audioUrl","audio","Audio","play","console","warn","usePrevious","value","useRef","useEffect","current","StyledContainer","div","breakpoints","up","SearchForm","string","func","input","onSubmit","onChange","TextField","fullWidth","autoFocus","label","variant","type","placeholder","name","InputProps","startAdornment","InputAdornment","position","TooltipButton","tooltip","onClick","disabled","icon","SpeakIcon","endAdornment","color","SearchIcon","Typography","ColoredPaper","Paper","palette","background","level1","TranslationResult","original","translation","useState","isHovering","setIsHovering","elevation","onMouseEnter","onMouseLeave","Box","py","px","textAlign","TRANSLATE_ROUTE","translate","from","to","extended","getWordListAndSentenceFromTranslation","maskedWord","group","toLowerCase","split","map","sentence","wordList","generateCards","hanziList","translationList","pinyinList","Array","length","fill","_","ind","id","fetchAndParseTranslationResult","currentChars","hanziGroup","translationGroup","transcription","pinyinGroup","cards","loadable","Body","smAndDown","useMediaQuery","t","down","bottomNavbarDiff","footerDiff","Learn","setInput","sentences","setSentences","setCards","previousInput","resetCards","e","preventDefault","previousChineseInputWithPunctuation","chineseInputWithPunctuation","chineseInput","resultCards","target","Lazy","fallback","LoadingIndicator","traceId"],"mappings":"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","file":"static/js/13.5ec9c9e0.chunk.js","sourcesContent":["import { bool, node } from 'prop-types';\r\n\r\nconst propTypes = {\r\n\tchildren: node.isRequired,\r\n\thorizontal: bool,\r\n\tvertical: bool,\r\n};\r\n\r\nconst defaultProps = {\r\n\thorizontal: true,\r\n\tvertical: false,\r\n};\r\n\r\nexport { propTypes, defaultProps };\r\n","import React from 'react';\r\nimport styled from 'styled-components';\r\nimport { Grid } from '@material-ui/core';\r\n\r\nimport { propTypes, defaultProps } from './types';\r\n\r\nconst StyledGrid = styled(Grid)`\r\n\twidth: 100%;\r\n\tdisplay: flex;\r\n\tflex-wrap: wrap;\r\n\t${({ $horizontal, $vertical }) => `\r\n\t\t${$horizontal && 'justify-content: center;'}\r\n\t\t${$vertical && 'height: 100%; align-items: center;'}\r\n\t`}\r\n`;\r\n\r\n/**\r\n * Centered Grid\r\n *\r\n * @component\r\n * @param {import('@material-ui/core').GridProps|import('react').HtmlHTMLAttributes}\r\n */\r\nconst ContainerWithCenteredItems = ({\r\n\tchildren,\r\n\thorizontal,\r\n\tvertical,\r\n\t...rest\r\n}) => (\r\n\t<StyledGrid $horizontal={horizontal} $vertical={vertical} {...rest}>\r\n\t\t{children}\r\n\t</StyledGrid>\r\n);\r\n\r\nContainerWithCenteredItems.propTypes = propTypes;\r\nContainerWithCenteredItems.defaultProps = defaultProps;\r\n\r\nexport default ContainerWithCenteredItems;\r\n","import styled from 'styled-components';\r\n\r\nconst StyledWrapper = styled.span`\r\n\t/* To ensure that the spacer properly exists to space around it */\r\n\twidth: 1px;\r\n\t${({ theme, $direction, $spacing }) => `\r\n\t\tmargin-${$direction}: ${theme.spacing($spacing)}px;\r\n\t`}\r\n`;\r\n\r\nexport default StyledWrapper;\r\n","import React from 'react';\r\nimport StyledWrapper from './StyledWrapper';\r\nimport { defaultProps, propTypes } from './types';\r\n\r\n/**\r\n * Element that adds margin to the given direction based on the\r\n * spacing amount. The amount is passed in to the spacing method\r\n * of Mui. By default 1-unit-spacing = 8px\r\n *\r\n * @example\r\n * ```js\r\n * <Spacer direction=\"right\" spacing=\"5\" />\r\n * ```\r\n *\r\n * @component\r\n */\r\nconst Spacer = ({ direction, spacing }) => (\r\n\t<StyledWrapper $direction={direction} $spacing={parseInt(spacing, 10)} />\r\n);\r\n\r\nSpacer.propTypes = propTypes;\r\nSpacer.defaultProps = defaultProps;\r\n\r\nexport default Spacer;\r\n","import { direction, numberOrString } from 'components/types';\r\n\r\nconst propTypes = {\r\n\t/**\r\n\t * - Which direction do you want to apply margin to\r\n\t */\r\n\tdirection: direction.isRequired,\r\n\t/**\r\n\t * - The amount is passed in to the spacing method of Mui.\r\n\t * - By default 1-unit-spacing = 8px\r\n\t */\r\n\tspacing: numberOrString,\r\n};\r\nconst defaultProps = {\r\n\tspacing: 1,\r\n};\r\n\r\nexport { propTypes, defaultProps };\r\n","const firstCapital = s => (s && s[0].toUpperCase() + s.slice(1)) || '';\r\n\r\n// https://stackoverflow.com/a/26188910/13161405\r\nconst pascalToSentence = str =>\r\n\tstr\r\n\t\t// Look for long acronyms and filter out the last letter\r\n\t\t.replace(/([A-Z]+)([A-Z][a-z])/g, ' $1 $2')\r\n\t\t// Look for lower-case letters followed by upper-case letters\r\n\t\t.replace(/([a-z\\d])([A-Z])/g, '$1 $2')\r\n\t\t// Look for lower-case letters followed by numbers\r\n\t\t.replace(/([a-zA-Z])(\\d)/g, '$1 $2')\r\n\t\t.replace(/^./, s => s.toUpperCase())\r\n\t\t// Remove any white space left around the word\r\n\t\t.trim();\r\n\r\nconst noop = () => null;\r\n\r\nexport { firstCapital, pascalToSentence, noop };\r\n","import { useFirestore, useFirestoreCollectionData } from 'reactfire';\r\n\r\nimport { devOrAnalyticsIsDisabled } from '../utils';\r\n\r\nconst useSearchQueries = () => {\r\n\tconst ref = useFirestore().collection('searchQueries');\r\n\tconst collection = useFirestoreCollectionData(ref.orderBy('createdOn'));\r\n\r\n\tconst add = query => {\r\n\t\tif (devOrAnalyticsIsDisabled) return;\r\n\r\n\t\tref.add({\r\n\t\t\tquery,\r\n\t\t\tcreatedOn: new Date(),\r\n\t\t});\r\n\t};\r\n\r\n\treturn { collection, add };\r\n};\r\n\r\nexport default useSearchQueries;\r\n","const REGEX_CHINESE = /\\p{Script=Han}/u;\r\nconst REGEX_PINYIN = /<td class=\"hanzi5-article-hanzi-info-td2\">(.*)<\\/td>/;\r\nconst REGEX_STRIP_NON_CHINESE_CHARS = /[^\\p{Script=Han}]+/gu;\r\nconst REGEX_STRIP_NON_CHINESE_AND_NON_SET_PUNCTUATION_CHARS = /[^\\p{Script=Han},.?!，、。？！]+/gu;\r\n\r\n/** @see https://github.com/sxei/pinyinjs/blob/3f0013841ba62a6d1af38e50839ea196b27369cb/pinyinUtil.js#L16 */\r\nconst TONE_MAP = {\r\n\tā: 'a',\r\n\tá: 'a',\r\n\tǎ: 'a',\r\n\tà: 'a',\r\n\tō: 'o',\r\n\tó: 'o',\r\n\tǒ: 'o',\r\n\tò: 'o',\r\n\tē: 'e',\r\n\té: 'e',\r\n\tě: 'e',\r\n\tè: 'e',\r\n\tī: 'i',\r\n\tí: 'i',\r\n\tǐ: 'i',\r\n\tì: 'i',\r\n\tū: 'u',\r\n\tú: 'u',\r\n\tǔ: 'u',\r\n\tù: 'u',\r\n\tü: 'v',\r\n\tǖ: 'v',\r\n\tǘ: 'v',\r\n\tǚ: 'v',\r\n\tǜ: 'v',\r\n\tń: 'n',\r\n\tň: 'n',\r\n\t'': 'm',\r\n};\r\n\r\nconst isChinese = text => REGEX_CHINESE.test(text);\r\nconst stripNonChineseChars = text =>\r\n\ttext.replace(REGEX_STRIP_NON_CHINESE_CHARS, '');\r\nconst stripNonChineseAndNonSetPunctionationChars = text =>\r\n\ttext.replace(REGEX_STRIP_NON_CHINESE_AND_NON_SET_PUNCTUATION_CHARS, '');\r\nconst removeTones = pinyin =>\r\n\tpinyin.replace(/[āáǎàōóǒòēéěèīíǐìūúǔùüǖǘǚǜńň]/g, match => TONE_MAP[match]);\r\n\r\nexport {\r\n\tREGEX_CHINESE,\r\n\tREGEX_PINYIN,\r\n\tREGEX_STRIP_NON_CHINESE_CHARS,\r\n\tREGEX_STRIP_NON_CHINESE_AND_NON_SET_PUNCTUATION_CHARS,\r\n\tisChinese,\r\n\tstripNonChineseChars,\r\n\tstripNonChineseAndNonSetPunctionationChars,\r\n\tremoveTones,\r\n};\r\n","import axios from 'axios';\r\n\r\nconst post = (url, body = {}, instance = axios) => instance.post(url, body);\r\n\r\nconst get = (url, params = {}, instance = axios) => {\r\n\treturn instance.get(url, {\r\n\t\tparams,\r\n\t});\r\n};\r\n\r\nconst put = (url, body, instance = axios) => instance.put(url, body);\r\n\r\nconst remove = (url, instance = axios) => instance.delete(url);\r\n\r\n// https://github.com/axios/axios#response-schema\r\nconst parse = async res => {\r\n\tconst { data } = await res;\r\n\treturn data;\r\n};\r\n\r\n// Set config defaults when creating the instance\r\nconst serverInstance = axios.create({\r\n\tbaseURL: process.env.REACT_APP_SERVER_URI,\r\n});\r\n\r\nconst server = {\r\n\tpost: (...props) => post(...props, serverInstance),\r\n\tget: (...props) => get(...props, serverInstance),\r\n\tput: (...props) => put(...props, serverInstance),\r\n\tdelete: (...props) => remove(...props, serverInstance),\r\n};\r\n\r\nexport { post, get, put, remove as delete, parse, server };\r\n","// #region CONSTANTS\r\n\r\nimport { get } from 'api/rest';\r\n\r\n/** @see https://github.com/sxei/pinyinjs/blob/3f0013841ba62a6d1af38e50839ea196b27369cb/pinyinUtil.js#L16 */\r\nconst TONE_MAP = {\r\n\tā: 'a1',\r\n\tá: 'a2',\r\n\tǎ: 'a3',\r\n\tà: 'a4',\r\n\tō: 'o1',\r\n\tó: 'o2',\r\n\tǒ: 'o3',\r\n\tò: 'o4',\r\n\tē: 'e1',\r\n\té: 'e2',\r\n\tě: 'e3',\r\n\tè: 'e4',\r\n\tī: 'i1',\r\n\tí: 'i2',\r\n\tǐ: 'i3',\r\n\tì: 'i4',\r\n\tū: 'u1',\r\n\tú: 'u2',\r\n\tǔ: 'u3',\r\n\tù: 'u4',\r\n\tü: 'v0',\r\n\tǖ: 'v1',\r\n\tǘ: 'v2',\r\n\tǚ: 'v3',\r\n\tǜ: 'v4',\r\n\tń: 'n2',\r\n\tň: 'n3',\r\n\t'': 'm2',\r\n};\r\n\r\nconst HAN_TRAINER_PRO_PREFIX = `https://www.hantrainerpro.de/resources/pronunciations/`;\r\nconst HAN_TRAINER_PRO_POSTFIX = '.mp3';\r\n\r\n// Don't recreate these on each speak\r\nconst synth = window.speechSynthesis;\r\nconst utterance = new SpeechSynthesisUtterance();\r\nutterance.pitch = 1;\r\nutterance.rate = 0.8;\r\n\r\nconst PINYIN_JS_URL = `https://cdn.jsdelivr.net/gh/sxei/pinyinjs/pinyinUtil.js`;\r\nconst PINYIN_JS_DICTIONARY_URL = `https://cdn.jsdelivr.net/gh/sxei/pinyinjs/dict/pinyin_dict_withtone.js`;\r\n\r\n// #endregion\r\n\r\n/**\r\n * HanTrainerPro uses direct mark to tone conversion, so we need to\r\n * parse single tone marks to their respective numbered tones.\r\n * - As an example, for hǎo:\r\n * \t- We would normally want hao3\r\n * \t\t- @see https://hantrainerpro.de/resources/pronunciations/hao3.mp3 (Error)\r\n * \t- But the api works with ha3o\r\n * \t\t- @see https://hantrainerpro.de/resources/pronunciations/ha3o.mp3 (Working)\r\n *\r\n * @see https://github.com/sxei/pinyinjs/blob/3f0013841ba62a6d1af38e50839ea196b27369cb/pinyinUtil.js#L260 (Algorithm)\r\n *\r\n * @example\r\n * markToNumberForHanTrainerPro(hǎo);\r\n * // returns ha3o\r\n *\r\n * @param {String} pinyin Pinyin to parse\r\n */\r\nconst markToNumberForHanTrainerPro = pinyin =>\r\n\tpinyin.replace(/[āáǎàōóǒòēéěèīíǐìūúǔùüǖǘǚǜńň]/g, match => TONE_MAP[match]);\r\n\r\n/**\r\n * Speaks the given word using SpeechSynthesisUtterance\r\n *\r\n * @param {String} text Hanzi to speak.\r\n */\r\nconst speak = text => {\r\n\tif (!text) return;\r\n\tif (synth.speaking) synth.cancel();\r\n\r\n\t// For some reason this fails in the first time\r\n\tif (!utterance.voice) {\r\n\t\tutterance.voice = synth.getVoices().find(v => v.lang === 'zh-CN');\r\n\t}\r\n\tutterance.text = text;\r\n\tsynth.speak(utterance);\r\n};\r\n\r\n/**\r\n * Imports pinyinJS dictionary and utility once\r\n *\r\n * @see https://github.com/sxei/pinyinjs\r\n */\r\nconst importPinyinJsIfNeeded = async () => {\r\n\tif (!window.pinyin_dict_withtone) {\r\n\t\tconst { data } = await get(PINYIN_JS_DICTIONARY_URL, {\r\n\t\t\theaders: {\r\n\t\t\t\taccept: 'text/js',\r\n\t\t\t},\r\n\t\t});\r\n\t\twindow.pinyin_dict_withtone = data.replace(\r\n\t\t\t/var pinyin_dict_withtone = |\"|;/g,\r\n\t\t\t''\r\n\t\t);\r\n\t}\r\n\tif (!window.pinyinUtil) {\r\n\t\t// await import('./pinyinUtil');\r\n\t\tconst { data } = await get(PINYIN_JS_URL, {\r\n\t\t\theaders: {\r\n\t\t\t\taccept: 'text/js',\r\n\t\t\t},\r\n\t\t});\r\n\r\n\t\t// eslint-disable-next-line no-eval\r\n\t\teval(data);\r\n\t}\r\n};\r\n\r\n/**\r\n * Tries a native speech via Han Trainer Pro w/ a fallback to\r\n * SpeechSynthesisUtterance\r\n *\r\n * @param {String} hanzi Hanzi character to speak.\r\n * @param {String} pinyin Pinyin for the given hanzi.\r\n */\r\nconst trySpeakNative = async (hanzi, pinyin = '') => {\r\n\tif (!hanzi) return;\r\n\r\n\t// If no pinyin was passed in, then we use pinyinjs rather than making\r\n\t// a google-translate api call, this can be cached later so it's ok\r\n\t// to make a rather bigger request\r\n\tlet _pinyin = pinyin;\r\n\tif (!_pinyin) {\r\n\t\tawait importPinyinJsIfNeeded();\r\n\t\t_pinyin = window.pinyinUtil.getPinyin(hanzi);\r\n\t}\r\n\tconst numberedPinyin = markToNumberForHanTrainerPro(_pinyin);\r\n\tconst audioUrl =\r\n\t\tHAN_TRAINER_PRO_PREFIX + numberedPinyin + HAN_TRAINER_PRO_POSTFIX;\r\n\ttry {\r\n\t\tconst audio = new Audio(audioUrl);\r\n\t\tawait audio.play();\r\n\t} catch (e) {\r\n\t\tconsole.warn(\r\n\t\t\t`Failed to fetch native speech, will play default speech. Failed on the following:`,\r\n\t\t\t{\r\n\t\t\t\tpinyin: _pinyin,\r\n\t\t\t\thanzi,\r\n\t\t\t\tnumberedPinyin,\r\n\t\t\t\taudioUrl,\r\n\t\t\t}\r\n\t\t);\r\n\t\tspeak(hanzi);\r\n\t}\r\n};\r\n\r\nexport { speak, trySpeakNative };\r\n","import { useEffect, useRef } from 'react';\r\n\r\n// https://usehooks.com/usePrevious/\r\nconst usePrevious = value => {\r\n\t// The ref object is a generic container whose current property is mutable ...\r\n\t// ... and can hold any value, similar to an instance property on a class\r\n\tconst ref = useRef();\r\n\r\n\t// Store current value in ref\r\n\tuseEffect(() => {\r\n\t\tref.current = value;\r\n\t}, [value]); // Only re-run if value changes\r\n\r\n\t// Return previous value (happens before update in useEffect above)\r\n\treturn ref.current;\r\n};\r\n\r\nexport default usePrevious;\r\n","import styled from 'styled-components';\r\n\r\nconst StyledContainer = styled.div`\r\n\tmargin: auto;\r\n\twidth: 90%;\r\n\t${({ theme }) => `\r\n\t\t${theme.breakpoints.up('sm')} {\r\n\t\t\twidth: 70%;\r\n\t\t}\r\n\t\t${theme.breakpoints.up('md')} {\r\n\t\t\twidth: 50%;\r\n\t\t}\r\n\t\t${theme.breakpoints.up('lg')} {\r\n\t\t\twidth: 50%;\r\n\t\t}\r\n\t\t\r\n\t\t\r\n\t`}\r\n`;\r\n\r\nexport default StyledContainer;\r\n","import React from 'react';\r\nimport { InputAdornment, TextField, Typography } from '@material-ui/core';\r\n\r\nimport { speak } from 'utils/speech';\r\nimport { SpeakIcon, SearchIcon } from 'icons';\r\nimport TooltipButton from 'components/TooltipButton';\r\nimport StyledContainer from './StyledContainer';\r\nimport { propTypes, defaultProps } from './types';\r\n\r\nconst SearchForm = ({ input, onSubmit, onChange }) => (\r\n\t<StyledContainer>\r\n\t\t<form onSubmit={onSubmit}>\r\n\t\t\t<TextField\r\n\t\t\t\tfullWidth\r\n\t\t\t\tautoFocus\r\n\t\t\t\tlabel=\"Search for Hanzi...\"\r\n\t\t\t\tvariant=\"outlined\"\r\n\t\t\t\ttype=\"search\"\r\n\t\t\t\tplaceholder=\"你好\"\r\n\t\t\t\tvalue={input}\r\n\t\t\t\tname=\"chinese-character\"\r\n\t\t\t\tonChange={onChange}\r\n\t\t\t\tInputProps={{\r\n\t\t\t\t\tstartAdornment: (\r\n\t\t\t\t\t\t<InputAdornment position=\"start\">\r\n\t\t\t\t\t\t\t<TooltipButton\r\n\t\t\t\t\t\t\t\ttooltip=\"Speak\"\r\n\t\t\t\t\t\t\t\tonClick={() => speak(input)}\r\n\t\t\t\t\t\t\t\tdisabled={!input}\r\n\t\t\t\t\t\t\t\ticon={SpeakIcon}\r\n\t\t\t\t\t\t\t/>\r\n\t\t\t\t\t\t</InputAdornment>\r\n\t\t\t\t\t),\r\n\t\t\t\t\tendAdornment: (\r\n\t\t\t\t\t\t<InputAdornment position=\"start\">\r\n\t\t\t\t\t\t\t<TooltipButton\r\n\t\t\t\t\t\t\t\ttooltip=\"Search\"\r\n\t\t\t\t\t\t\t\tdisabled={!input}\r\n\t\t\t\t\t\t\t\tcolor=\"primary\"\r\n\t\t\t\t\t\t\t\ticon={SearchIcon}\r\n\t\t\t\t\t\t\t\ttype=\"submit\"\r\n\t\t\t\t\t\t\t/>\r\n\t\t\t\t\t\t</InputAdornment>\r\n\t\t\t\t\t),\r\n\t\t\t\t}}\r\n\t\t\t/>\r\n\t\t\t<br />\r\n\t\t\t<Typography color=\"primary\" variant=\"caption\">\r\n\t\t\t\tNOTE\r\n\t\t\t</Typography>\r\n\t\t\t{`: `}\r\n\t\t\t<Typography variant=\"caption\">\r\n\t\t\t\tRecognized characters are\r\n\t\t\t\t{` `}\r\n\t\t\t\t<Typography color=\"primary\" variant=\"caption\">\r\n\t\t\t\t\tHanzi\r\n\t\t\t\t</Typography>\r\n\t\t\t\t{`, `}\r\n\t\t\t\t<Typography color=\"primary\" variant=\"caption\">\r\n\t\t\t\t\tcomma\r\n\t\t\t\t</Typography>\r\n\t\t\t\t{`, `}\r\n\t\t\t\t<Typography color=\"primary\" variant=\"caption\">\r\n\t\t\t\t\tdot\r\n\t\t\t\t</Typography>\r\n\t\t\t\t{`, `}\r\n\t\t\t\t<Typography color=\"primary\" variant=\"caption\">\r\n\t\t\t\t\texclamation mark\r\n\t\t\t\t</Typography>\r\n\t\t\t\t{`, and `}\r\n\t\t\t\t<Typography color=\"primary\" variant=\"caption\">\r\n\t\t\t\t\tquestion mark\r\n\t\t\t\t</Typography>\r\n\t\t\t\t.\r\n\t\t\t</Typography>\r\n\t\t</form>\r\n\t</StyledContainer>\r\n);\r\n\r\nSearchForm.propTypes = propTypes;\r\nSearchForm.defaultProps = defaultProps;\r\n\r\nexport default SearchForm;\r\n","import { string, func } from 'prop-types';\r\n\r\nconst propTypes = {\r\n\tinput: string,\r\n\tonSubmit: func.isRequired,\r\n\tonChange: func.isRequired,\r\n};\r\n\r\nconst defaultProps = {\r\n\tstring: '',\r\n};\r\n\r\nexport { propTypes, defaultProps };\r\n","import { string } from 'prop-types';\r\n\r\nconst propTypes = {\r\n\ttranslation: string,\r\n\tpinyin: string,\r\n};\r\nconst defaultProps = {\r\n\ttranslation: '',\r\n\tpinyin: '',\r\n};\r\n\r\nexport { propTypes, defaultProps };\r\n","import { Paper } from '@material-ui/core';\r\nimport styled from 'styled-components';\r\n\r\nconst ColoredPaper = styled(Paper)`\r\n\t${({ theme }) => `\r\n\t\tmargin: ${theme.spacing(2, 0)};\r\n\t\tbackground-color: ${theme.palette.background.level1};\r\n\t\ttext-align: left;\r\n\t`}\r\n`;\r\n\r\nexport default ColoredPaper;\r\n","import React, { useState } from 'react';\r\nimport { Box, Typography } from '@material-ui/core';\r\n\r\nimport ContainerWithCenteredItems from 'components/ContainerWithCenteredItems';\r\nimport { propTypes, defaultProps } from './types';\r\nimport ColoredPaper from './ColoredPaper';\r\n\r\nconst TranslationResult = ({ original, translation, pinyin }) => {\r\n\tconst [isHovering, setIsHovering] = useState(false);\r\n\tconst onEnter = () => setIsHovering(true);\r\n\tconst onLeave = () => setIsHovering(false);\r\n\r\n\treturn (\r\n\t\t<ContainerWithCenteredItems>\r\n\t\t\t<ColoredPaper\r\n\t\t\t\televation={(isHovering && 3) || 0}\r\n\t\t\t\tonMouseEnter={onEnter}\r\n\t\t\t\tonMouseLeave={onLeave}\r\n\t\t\t>\r\n\t\t\t\t<Box py={2} px={4} textAlign=\"left\">\r\n\t\t\t\t\t<Typography> {original} </Typography>\r\n\t\t\t\t\t<Typography> {pinyin} </Typography>\r\n\t\t\t\t\t<Typography> {translation} </Typography>\r\n\t\t\t\t</Box>\r\n\t\t\t</ColoredPaper>\r\n\t\t</ContainerWithCenteredItems>\r\n\t);\r\n};\r\n\r\nTranslationResult.propTypes = propTypes;\r\nTranslationResult.defaultProps = defaultProps;\r\n\r\nexport default TranslationResult;\r\n","import { server, parse } from './rest';\r\n\r\nconst TRANSLATE_ROUTE = 'translate';\r\n\r\nconst translate = (\r\n\ttext,\r\n\tparams = {\r\n\t\tfrom: 'zh-CN',\r\n\t\tto: 'en',\r\n\t\textended: true,\r\n\t}\r\n) => parse(server.get(TRANSLATE_ROUTE, { ...params, text }));\r\n\r\nexport default translate;\r\n","import { firstCapital } from 'utils';\r\nimport { stripNonChineseChars } from 'utils/chinese';\r\nimport translate from 'api/translateApi';\r\n\r\nconst splitAndTrim = w => w.split('|').map(s => s.trim());\r\n\r\nconst getWordListAndSentenceFromTranslation = maskedWord => {\r\n\tconst group = splitAndTrim(maskedWord.toLowerCase());\r\n\tconst sentence = firstCapital(group[0]);\r\n\tconst wordList = group.slice(1);\r\n\treturn {\r\n\t\tsentence,\r\n\t\twordList,\r\n\t};\r\n};\r\n\r\nconst generateCards = (hanziList, translationList, pinyinList) =>\r\n\tArray(hanziList.length)\r\n\t\t.fill(0)\r\n\t\t.map((_, ind) => ({\r\n\t\t\ttext: hanziList[ind],\r\n\t\t\tid: ind + hanziList[ind],\r\n\t\t\thanzi: hanziList[ind],\r\n\t\t\ttranslation: translationList[ind],\r\n\t\t\tpinyin: pinyinList[ind],\r\n\t\t}));\r\n\r\nconst fetchAndParseTranslationResult = async currentChars => {\r\n\tconst hanziGroup = stripNonChineseChars(currentChars).split('');\r\n\tconst res = await translate(currentChars);\r\n\tconst {\r\n\t\tsentence: translation,\r\n\t\twordList: translationGroup,\r\n\t} = getWordListAndSentenceFromTranslation(res.translation);\r\n\tconst {\r\n\t\tsentence: pinyin,\r\n\t\twordList: pinyinGroup,\r\n\t} = getWordListAndSentenceFromTranslation(res.transcription);\r\n\r\n\treturn {\r\n\t\ttranslation,\r\n\t\tpinyin,\r\n\t\tcards: generateCards(hanziGroup, translationGroup, pinyinGroup),\r\n\t};\r\n};\r\n\r\nexport { fetchAndParseTranslationResult };\r\n","import loadable from 'utils/loadable';\r\n\r\nexport default loadable(() => import('./index'));\r\n","import { Grid, useMediaQuery } from '@material-ui/core';\r\nimport styled from 'styled-components';\r\n\r\nconst Body = styled(Grid)`\r\n\t${({ theme }) => {\r\n\t\tconst smAndDown = useMediaQuery(t => t.breakpoints.down('sm'));\r\n\t\t// This always appears\r\n\t\tconst topNavbarDiff = '64px';\r\n\t\t// This only appears on small device\r\n\t\tconst bottomNavbarDiff = (smAndDown && ' + 56px') || '';\r\n\t\t// This only appears on bigger device\r\n\t\tconst footerDiff = (!smAndDown && ' + 30px') || '';\r\n\r\n\t\treturn `\r\n\t\t&.MuiGrid-root {\r\n\t\t\t// Navigation + Footer + BottomNavbar (if mobile)\r\n\t\t\theight: calc(100% - (${topNavbarDiff}${bottomNavbarDiff}${footerDiff}));\r\n\t\t}\r\n\t\tpadding: ${theme.spacing(3, 0, (smAndDown && 15) || 3)};\r\n\t`;\r\n\t}}\r\n\tposition: relative;\r\n\twidth: 100%;\r\n\toverflow: auto;\r\n`;\r\n\r\nexport default Body;\r\n","import React, { useEffect, useState } from 'react';\r\n\r\nimport useSearchQueries from 'store/firebase/hooks/useSearchQueries';\r\nimport {\r\n\tstripNonChineseChars,\r\n\tstripNonChineseAndNonSetPunctionationChars,\r\n} from 'utils/chinese';\r\nimport usePrevious from 'hooks/usePrevious';\r\nimport SearchForm from 'components/SearchForm';\r\nimport TranslationResult from 'components/TranslationResult';\r\nimport Spacer from 'components/Spacer';\r\nimport ContainerWithCenteredItems from 'components/ContainerWithCenteredItems';\r\nimport { fetchAndParseTranslationResult } from './utils';\r\nimport LazyCardGrid from './CardGrid/Lazy';\r\nimport Body from './Body';\r\n\r\nconst Learn = () => {\r\n\tconst [input, setInput] = useState('');\r\n\tconst [sentences, setSentences] = useState({});\r\n\tconst [cards, setCards] = useState([]);\r\n\tconst previousInput = usePrevious(input);\r\n\tconst { add } = useSearchQueries();\r\n\r\n\tconst resetCards = () => {\r\n\t\tsetCards([]);\r\n\t\tsetSentences({});\r\n\t};\r\n\r\n\tconst onChange = e => {\r\n\t\tconst { value } = e.target;\r\n\t\tsetInput(value);\r\n\t\tif (!value && cards.length) resetCards();\r\n\t};\r\n\r\n\tconst onSubmit = async e => {\r\n\t\te.preventDefault();\r\n\r\n\t\t// eslint-disable-next-line max-len\r\n\t\tconst previousChineseInputWithPunctuation = stripNonChineseAndNonSetPunctionationChars(\r\n\t\t\tpreviousInput\r\n\t\t);\r\n\t\t// eslint-disable-next-line max-len\r\n\t\tconst chineseInputWithPunctuation = stripNonChineseAndNonSetPunctionationChars(\r\n\t\t\tinput\r\n\t\t);\r\n\r\n\t\t// Don't search twice using the same query\r\n\t\t// eslint-disable-next-line max-len\r\n\t\tif (\r\n\t\t\tpreviousChineseInputWithPunctuation === chineseInputWithPunctuation\r\n\t\t) {\r\n\t\t\t// If there are unrecognized chars, reset them\r\n\t\t\tif (input !== chineseInputWithPunctuation) {\r\n\t\t\t\tsetInput(chineseInputWithPunctuation);\r\n\t\t\t}\r\n\t\t\treturn;\r\n\t\t}\r\n\r\n\t\tconst chineseInput = stripNonChineseChars(chineseInputWithPunctuation);\r\n\r\n\t\tif (chineseInput) {\r\n\t\t\tadd(chineseInput);\r\n\t\t\tsetInput(chineseInputWithPunctuation);\r\n\t\t\tconst {\r\n\t\t\t\ttranslation,\r\n\t\t\t\tpinyin,\r\n\t\t\t\tcards: resultCards,\r\n\t\t\t} = await fetchAndParseTranslationResult(\r\n\t\t\t\tchineseInputWithPunctuation\r\n\t\t\t);\r\n\r\n\t\t\tsetSentences({\r\n\t\t\t\toriginal: chineseInputWithPunctuation,\r\n\t\t\t\ttranslation,\r\n\t\t\t\tpinyin,\r\n\t\t\t});\r\n\t\t\tsetCards(resultCards);\r\n\t\t\treturn;\r\n\t\t}\r\n\t\tif (cards.length) resetCards();\r\n\t\tsetInput('');\r\n\t};\r\n\r\n\tuseEffect(() => {}, [input]);\r\n\r\n\treturn (\r\n\t\t<Body>\r\n\t\t\t<ContainerWithCenteredItems>\r\n\t\t\t\t<SearchForm\r\n\t\t\t\t\tinput={input}\r\n\t\t\t\t\tonChange={onChange}\r\n\t\t\t\t\tonSubmit={onSubmit}\r\n\t\t\t\t/>\r\n\t\t\t\t{sentences.translation && <TranslationResult {...sentences} />}\r\n\t\t\t\t<Spacer direction=\"bottom\" spacing=\"2\" />\r\n\t\t\t\t<LazyCardGrid cards={cards} />\r\n\t\t\t</ContainerWithCenteredItems>\r\n\t\t</Body>\r\n\t);\r\n};\r\n\r\nexport default Learn;\r\n","import React from 'react';\r\nimport { SuspenseWithPerf } from 'reactfire';\r\n\r\nimport PracticeContainer from 'containers/Learn';\r\nimport LoadingIndicator from 'components/LoadingIndicator';\r\n\r\nconst Learn = () => (\r\n\t<SuspenseWithPerf fallback={<LoadingIndicator />} traceId=\"load-learn\">\r\n\t\t<PracticeContainer />\r\n\t</SuspenseWithPerf>\r\n);\r\n\r\nexport default Learn;\r\n"],"sourceRoot":""}