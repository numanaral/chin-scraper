{"version":3,"sources":["components/Popover/types.js","components/Popover/Popover.js","containers/Practice/constants.js","containers/Practice/useOnResize.js","components/Switch/Lazy.js","hooks/useSwitches.js","containers/Practice/useSwitchesWithPersistedConfig.js","hooks/useIsFirstMount.js","hooks/useEffectOnUpdate.js","containers/Practice/useHanziWriter.js","hooks/useInput.js","containers/Practice/useInputWithCharacterList.js","containers/Practice/useIndex.js","containers/Practice/Practice.js","routes/pages/Practice.js","components/ContainerWithCenteredItems/types.js","components/ContainerWithCenteredItems/ContainerWithCenteredItems.js","components/Spacer/StyledWrapper.js","components/Spacer/Spacer.js","components/Spacer/types.js","store/firebase/hooks/useSearchQueries.js","utils/chinese.js","api/rest.js","components/Hanzi/constants.js","utils/speech.js","hooks/usePrevious.js","components/Hanzi/types.js","components/Hanzi/Background/Plain.js","components/Hanzi/Background/types.js","components/Hanzi/Background/RiceGrid.js","components/Hanzi/Background/Background.js","components/Hanzi/Hanzi.js","components/Hanzi/useHanzi.js"],"names":["element","isRequired","bool","objectOf","string","icon","Wrapper","styled","div","Popover","component","anchorOrigin","transformOrigin","passDownOnCloseProp","tooltip","text","rest","useState","anchorEl","setAnchorEl","onClose","isPopoverOpen","Boolean","id","undefined","TooltipButton","aria-describedby","onClick","e","stopPropagation","currentTarget","open","cloneElement","popoverOnClose","defaultProps","vertical","horizontal","PRACTICE_CONFIG","riceGrid","label","value","shuffle","continuous","challenge","autoPlay","highlightOnceOnChallengeMode","ICON_SIZE","useOnResize","ref","useRef","spacing","useTheme","getSmallest","window","document","body","clientWidth","clientHeight","size","setSize","useEffect","handleResize","current","_size","addEventListener","removeEventListener","loadable","generateSwitchList","state","onCheck","Object","keys","map","key","Lazy","name","checked","useSwitches","initialState","cb","switches","setSwitches","useCallback","prev","newValues","switchList","useMemo","reduce","acc","useSwitchesWithPersistedConfig","useLocalStorage","practiceConfig","setPracticeConfig","useIsFirstMount","firstMount","useEffectOnUpdate","effect","dependencies","cleanup","isFirstMount","useHanziWriter","characters","index","writeConfig","startMode","START_MODES","QUIZ_CHALLENGE_HIGHLIGHT_ONCE","QUIZ_CHALLENGE","QUIZ","useHanzi","hanzi","rewrite","writer","useInput","initialValue","input","setInput","onChange","target","useInputWithCharacterList","add","useSearchQueries","setCharacters","previousHanzi","usePrevious","getCharacterList","shuffleArray","split","onSubmit","a","preventDefault","currentHanzi","stripNonChineseChars","restart","v","useIndex","restartDependencyArray","restartCallback","setIndex","isPreviousDisabled","isNextDisabled","length","onPrevious","onNext","onRestart","StyledPaper","Paper","theme","$size","palette","background","level2","StyledTooltipButton","Practice","smAndDown","useMediaQuery","breakpoints","down","pendingSpeechScraper","setPendingSpeechScraper","pageRef","textFieldProps","getOrder","order","style","_switchList","switchComponent","ind","onSpeak","trySpeakNative","console","error","PageContainer","innerRef","TextField","variant","type","InputProps","endAdornment","InputAdornment","position","disabled","color","SubmitIcon","iconSize","fontSize","ContainerWithCenteredItems","container","alignItems","elevation","Box","width","padding","textAlign","justify","PreviousIcon","Spacer","direction","Grid","item","xs","md","loading","SpeakIcon","NextIcon","ReplayIcon","fallback","LoadingIndicator","traceId","node","StyledGrid","$horizontal","$vertical","children","StyledWrapper","span","$direction","$spacing","numberOrString","parseInt","useIsAnalyticsEnabled","analyticsIsEnabled","useFirestore","collection","useFirestoreCollectionData","orderBy","query","createdOn","Date","REGEX_STRIP_NON_CHINESE_CHARS","REGEX_STRIP_NON_CHINESE_AND_NON_SET_PUNCTUATION_CHARS","TONE_MAP","ā","á","ǎ","à","ō","ó","ǒ","ò","ē","é","ě","è","ī","í","ǐ","ì","ū","ú","ǔ","ù","ü","ǖ","ǘ","ǚ","ǜ","ń","ň","replace","stripNonChineseAndNonSetPunctionationChars","removeTones","pinyin","match","post","url","instance","axios","get","params","put","remove","delete","parse","res","data","serverInstance","create","baseURL","process","server","props","getDefaultHanziWriterOptions","height","strokeColor","primary","main","radicalColor","success","delayBetweenStrokes","delayBetweenLoops","drawingColor","LOOP","DRAW_ONCE","DEFAULT_OPTIONS","hanziWriterOptions","HAN_TRAINER_PRO_PREFIX","HAN_TRAINER_PRO_POSTFIX","synth","utterance","speechSynthesis","SpeechSynthesisUtterance","pitch","rate","PINYIN_JS_URL","PINYIN_JS_DICTIONARY_URL","markToNumberForHanTrainerPro","speak","speaking","cancel","voice","getVoices","find","lang","alert","importPinyinJsIfNeeded","pinyin_dict_withtone","headers","accept","pinyinUtil","eval","_pinyin","getPinyin","numberedPinyin","audioUrl","audio","Audio","play","warn","propTypes","refType","Plain","memo","forwardRef","opacity","RiceGrid","StyledLine","stroke","strokeOpacity","xmlns","x1","y1","x2","y2","Background","Bg","Hanzi","character","options","bgSize","setBgSize","setWriter","charRef","writeHanzi","newCharacter","newOptions","_options","showOutline","showCharacter","querySelectorAll","forEach","hanziWriter","HanziWriter","recursiveQuiz","quiz","onComplete","setTimeout","loopCharacterAnimation"],"mappings":"sUAKYA,UAAQC,WACEC,OACPC,mBAASC,UACND,mBAASC,UACjBA,SACHA,SACNC,I,mYCJD,IAAMC,EAAUC,IAAOC,IAAV,KAoBPC,EAAU,SAAC,GASV,IARNC,EAQK,EARLA,UACAC,EAOK,EAPLA,aACAC,EAMK,EANLA,gBACAC,EAKK,EALLA,oBACAC,EAIK,EAJLA,QACAC,EAGK,EAHLA,KACAV,EAEK,EAFLA,KACGW,EACE,8GAC2BC,mBAAS,MADpC,mBACEC,EADF,KACYC,EADZ,KAOCC,EAAU,WACfD,EAAY,OAGPE,EAAgBC,QAAQJ,GACxBK,EAAKF,EAAgB,sBAAmBG,EAE9C,OACC,eAAClB,EAAD,WACC,cAACmB,EAAA,EAAD,CACCC,mBAAkBH,EAClBT,QAASA,EACTa,QAhBa,SAAAC,GACfA,EAAEC,kBACFV,EAAYS,EAAEE,gBAeZf,KAAMA,EACNV,KAAMA,IAEP,cAAC,IAAD,yBACCkB,GAAIA,EACJQ,KAAMV,EACNH,SAAUA,EACVE,QAASA,EACTT,aAAcA,EACdC,gBAAiBA,GACbI,GAPL,aASGH,GACDmB,uBAAatB,EAAW,CAAEuB,eAAgBb,KAC1CV,SAOLD,EAAQyB,aD/Da,CACpBrB,qBAAqB,EACrBF,aAAc,CACbwB,SAAU,SACVC,WAAY,UAEbxB,gBAAiB,CAChBuB,SAAU,MACVC,WAAY,UAEbtB,QAAS,GACTC,KAAM,KACNV,KAAM,MCqDQI,Q,yBC/ET4B,EAAkB,CACvBC,SAAU,CACTC,MAAO,qBACPC,OAAO,GAERC,QAAS,CACRF,MAAO,UACPC,OAAO,GAERE,WAAY,CACXH,MAAO,aACPC,OAAO,GAERG,UAAW,CACVJ,MAAO,iBACPC,OAAO,GAERI,SAAU,CACTL,MAAO,iBACPC,OAAO,GAERK,6BAA8B,CAC7BN,MAAO,mCACPC,OAAO,IAMHM,EAAY,QCaHC,EApCK,WACnB,IAAMC,EAAMC,mBACJC,EAAYC,cAAZD,QAFiB,EAGDjC,mBACvBmC,YACCC,OAAOC,SAASC,KAAKC,YACrBH,OAAOC,SAASC,KAAKE,aDcP,MCpBS,mBAGlBC,EAHkB,KAGZC,EAHY,KA8BzB,OAnBAC,qBAAU,WACT,IAAMC,EAAe,WACpB,GAAIb,EAAIc,QAAS,CAChB,IAAMC,EACLX,YACCJ,EAAIc,QAAQN,YACZR,EAAIc,QAAQL,aDGD,KCDRP,EAAQ,GACbS,EAAQI,KAKV,OAFAF,IACAR,OAAOW,iBAAiB,SAAUH,GAC3B,WACNR,OAAOY,oBAAoB,SAAUJ,MAEpC,CAACX,IAEG,CACNF,MACAU,S,gBCpCaQ,eAAS,kBAAM,iCAAmB,SCE3CC,EAAqB,SAACC,EAAOC,GAAR,OAC1BC,OAAOC,KAAKH,GAAOI,KAAI,SAAAC,GAAQ,IAAD,EACJL,EAAMK,GAAvBjC,EADqB,EACrBA,MAAOD,EADc,EACdA,MACf,OACC,cAACmC,EAAD,CAECC,KAAMF,EACNlC,MAAOA,EACPqC,QAASpC,EACT6B,QAASA,GAJJI,OAiDMI,EAxCK,SAACC,GAA6B,IAAfC,EAAc,uDAAT,KAAS,EAChB9D,mBAAS6D,GADO,mBACzCE,EADyC,KAC/BC,EAD+B,KAG1CZ,EAAUa,uBACf,SAACT,EAAKjC,GACLyC,GAAY,SAAAE,GACX,IAAMC,EAAS,2BACXD,GADW,IAEd,CAACV,GAAD,2BACIU,EAAKV,IADT,IAECjC,YAKF,OAFE,OAAFuC,QAAE,IAAFA,KAAKK,GAEEA,OAGT,CAACL,IAGIM,EAAaC,mBAAQ,kBAAMnB,EAAmBa,EAAUX,KAAU,CACvEW,EACAX,IAGD,MAAO,CACNW,SAAUV,OAAOC,KAAKS,GAAUO,QAC/B,SAACC,EAAKf,GAAN,mBAAC,eACGe,GADJ,IAEC,CAACf,GAAMO,EAASP,GAAKjC,UAEtB,IAEDyC,cACAZ,UACAgB,eCtCaI,EATwB,WAAO,IAAD,EACAC,YJmBH,iBIjBxCrD,GAH2C,mBACrCsD,EADqC,KACrBC,EADqB,KAM5C,OAAOf,EAAYc,EAAgBC,I,kBCCrBC,EAZS,WACvB,IAAMC,EAAa7C,kBAAO,GAE1B,OAAI6C,EAAWhC,SACdgC,EAAWhC,SAAU,GAEd,GAGDgC,EAAWhC,SCIJiC,EAXW,SAACC,EAAQC,EAAcC,GAChD,IAAMC,EAAeN,IAErBjC,qBAAU,WAET,OADKuC,GAAcH,IACZE,IAGLD,IC0BWG,EAhCQ,SAAC,GAA2C,IAAzC1C,EAAwC,EAAxCA,KAAM2C,EAAkC,EAAlCA,WAAYC,EAAsB,EAAtBA,MAAOtB,EAAe,EAAfA,SAC1C1C,EAAsD0C,EAAtD1C,SAAUK,EAA4CqC,EAA5CrC,UAEZ4D,EAAc,CACnB7C,OACApB,WACAkE,UAL6DxB,EAAjCnC,8BAO1B4D,IAAYC,+BACZ/D,GAAa8D,IAAYE,gBAC1BF,IAAYG,MAVmD,EAa9BC,YAASR,EAAWC,GAAQC,GAAvDO,EAbyD,EAazDA,MAAOC,EAbkD,EAalDA,QAASC,EAbyC,EAazCA,OAcxB,OARAjB,GAAkB,WAHjBgB,EAAQV,EAAWC,GAAQC,KAKzB,CAACjE,EAAUoB,EAAM4C,EAAOD,IAE3BzC,qBAAU,WACH,OAANoD,QAAM,IAANA,KAAM,UAAOrE,EAAa,OAAW,OAA/B,gBACJ,CAACqE,EAAQrE,IAEL,CACNmE,UCpBaG,EAZE,WAAwB,IAAvBC,EAAsB,uDAAP,GAAO,EACbjG,mBAASiG,GADI,mBAChCC,EADgC,KACzBC,EADyB,KAGjCC,EAAW,SAAAzF,GAAC,OAAIwF,EAASxF,EAAE0F,OAAO9E,QAExC,MAAO,CACN2E,QACAC,WACAC,a,2BCkDaE,EApDmB,SAACL,EAAczE,EAASF,GAAW,IAC5DiF,EAAQC,cAARD,IAD2D,EAEpBP,EAASC,GAAhDC,EAF2D,EAE3DA,MAAOC,EAFoD,EAEpDA,SAAUC,EAF0C,EAE1CA,SAAarG,EAF6B,iDAG/BC,mBAAS,IAHsB,mBAG5DoF,EAH4D,KAGhDqB,EAHgD,KAI7DC,EAAgBC,YAAYT,GAE5BU,EAAmB,eAAC9G,EAAD,uDAAQoG,EAAR,OACvB1E,GAAWqF,YAAa/G,IAAUA,EAAKgH,MAAM,KAMzCC,EAAQ,uCAAG,WAAMpG,GAAN,eAAAqG,EAAA,yDAChBrG,EAAEsG,iBAEIC,EAAeC,YAAqBjB,GAEtCiB,YAAqBT,KAAmBQ,EAL5B,uBAMXR,IAAkBR,GAAOC,EAASe,GACjCA,GAAcT,EAAc,IAPlB,8BAWZS,EAXY,wBAYfX,EAAIW,GACJf,EAASe,GACTT,EAAcG,EAAiBM,IAdhB,2BAmBhBT,EAAc,IACdN,EAAS,IApBO,4CAAH,sDA4Bd,OALAxD,qBAAU,WACT8D,EAAcG,OAEZ,IAEI,aACNxB,aACAc,QACAkB,QAnCe,WACfX,GAAc,SAAAY,GAAC,OAAIT,EAAkBpF,GAAW6F,GAAMnB,OAmCtDE,WACAW,WACAzF,SACGvB,IC3BUuH,GAzBE,SAACpB,EAAOqB,GAAoD,IAA5BC,EAA2B,uDAAT,KAAS,EACjDxH,mBAAS,GADwC,mBACpEqF,EADoE,KAC7DoC,EAD6D,KAErEC,EAA+B,IAAVrC,EACrBsC,EAAiBtC,EAAQ,IAAMa,EAAM0B,OACrCC,EAAa,kBAAMJ,GAAS,SAAAJ,GAAC,OAAIA,EAAI,MACrCS,EAAS,kBAAML,GAAS,SAAAJ,GAAC,OAAIA,EAAI,MACjCU,EAAY,WACjBN,EAAS,GACM,OAAfD,QAAe,IAAfA,QAOD,OAJA1C,GAAkB,WACjBiD,MACER,GAEI,CACNlC,QACAqC,qBACAC,iBACAE,aACAC,SACAC,c,wMCOF,IAAMC,GAAc1I,YAAO2I,IAAP3I,CAAH,MACd,gBAAG4I,EAAH,EAAGA,MAAOC,EAAV,EAAUA,MAAV,iEAEmBD,EAAME,QAAQC,WAAWC,OAF5C,2BAGUJ,EAAMjG,QAAQ,GAHxB,oBAIEkG,GAAK,iBAAcA,EAAd,OAA4B,GAJnC,WAQGI,GAAsBjJ,YAAOkB,IAAPlB,CAAH,MAuLVkJ,GAjLE,WAChB,IAAMC,EAAYC,aAAc,SAAAR,GAAK,OAAIA,EAAMS,YAAYC,KAAK,SAD1C,EAEkC5I,oBAAS,GAF3C,mBAEf6I,EAFe,KAEOC,EAFP,OAIShH,IAAlBiH,EAJS,EAIdhH,IAAcU,EAJA,EAIAA,KAJA,EAKW+B,IAAzBT,EALc,EAKdA,SAAUK,EALI,EAKJA,WALI,EAYlBkC,EAA0B,GAAIvC,EAASvC,QAAS,kBALnD4D,EAPqB,EAOrBA,WACAgC,EARqB,EAQrBA,QACAlB,EATqB,EASrBA,MACAa,EAVqB,EAUrBA,SACGiC,EAXkB,6DAqBlB1B,GAASpB,EAAO,CAACnC,EAASvC,SAAU4F,GANvC/B,EAfqB,EAerBA,MACAqC,EAhBqB,EAgBrBA,mBACAC,EAjBqB,EAiBrBA,eACAE,EAlBqB,EAkBrBA,WACAC,EAnBqB,EAmBrBA,OACAC,EApBqB,EAoBrBA,UAGOlC,EAAUV,EAAe,CAChC1C,OACA2C,aACAC,QACAtB,aAJO8B,MAOFoD,EAAW,SAAAC,GAAK,MAAK,CAC1BC,MAAO,CACND,WAIIE,EAAchF,EAAWb,KAAI,SAAC8F,EAAiBC,GAAlB,OAClC,gCACED,EACD,yBAFSC,MAMLC,EAAO,uCAAG,sBAAAvC,EAAA,sEAEd8B,GAAwB,GAFV,SAGRU,YAAepE,EAAWC,IAHlB,sDAKdoE,QAAQC,MAAM,mBALA,uBAOdZ,GAAwB,GAPV,0EAAH,qDAiBb,OALAnG,qBAAU,WACLoB,EAASpC,UAAU4H,MAErB,CAAClE,IAGH,eAACsE,EAAA,EAAD,CAAeC,SAAUb,EAAzB,UAEC,sBAAMhC,SAAUA,EAAhB,SACC,cAAC8C,EAAA,EAAD,aACCtI,MAAO2E,EACP4D,QAAQ,WACRC,KAAK,SACLC,WAAY,CACXC,aACC,cAACC,EAAA,EAAD,CAAgBC,SAAS,QAAzB,SACC,qCACC,cAAC3J,EAAA,EAAD,CACCX,QAAQ,SACRuK,UAAWlE,EACXmE,MAAM,UACNjL,KAAMkL,IACNC,SAAS,QACTR,KAAK,WAELtB,GACA,cAAC,EAAD,CACCrJ,KAEC,cAAC,IAAD,CAAcoL,SAAS,UAExB/K,UACC,cAACuI,GAAD,CAAaG,MAAO,IAApB,SACEiB,aASLJ,OAIJP,GACD,cAACgC,EAAA,EAAD,CAA4BC,WAAS,EAACC,WAAW,SAAjD,SACC,cAAC1C,EAAA,EAAD,CAAO2C,UAAW,EAAlB,SACC,cAACC,EAAA,EAAD,CAAKC,MAAO,IAAKC,QAAS,EAAGC,UAAU,OAAvC,SACE5B,UAMFhE,EAAWwC,QACb,eAAC6C,EAAA,EAAD,CACCC,WAAS,EACTC,WAAW,SACXM,QAAQ,gBAHT,UAMC,gDAAShC,EAAS,IAAlB,cACC,cAACzI,EAAA,EAAD,CACCX,QAAQ,WACRT,KAAM8L,IACNX,SAAU1I,EACVnB,QAASmH,EACTuC,SAAU1C,IAEX,cAACyD,EAAA,EAAD,CAAQjC,MAAM,IAAIkC,UAAU,QAAQnJ,QAAQ,WAG7C,cAACoJ,EAAA,EAAD,uCACM5C,GAAa,CACjBiC,WAAW,EACXO,QAAS,WAHX,IAKCK,MAAI,EACJC,GAAI,GACJC,GAAG,QACCvC,EAAUR,EAAa,EAAM,IARlC,aAUC,eAACT,GAAD,CAAa4C,UAAW,EAAxB,UACC,cAACrC,GAAD,CACC1I,QAAQ,QACRa,QAAS6I,EACTa,UAAWlE,EACXuF,QAAS5C,EACT0B,SAAU1I,EACVzC,KAAMsM,MAEN7F,QAIH,gDAASoD,EAAS,IAAlB,cACC,cAACkC,EAAA,EAAD,CAAQjC,MAAM,IAAIkC,UAAU,OAAOnJ,QAAQ,SACvC0F,IAAmB5D,EAAStC,aAC/B,cAACjB,EAAA,EAAD,CACCX,QAAQ,OACRT,KAAMuM,IACNpB,SAAU1I,EACVnB,QAASoH,EACTsC,SAAUzC,KAGX,cAACnH,EAAA,EAAD,CACCX,QAAQ,UACRT,KAAMwM,IACNrB,SAAU1I,EACVnB,QAASqH,e,SC1MFS,UANE,kBAChB,cAAC,IAAD,CAAkBqD,SAAU,cAACC,GAAA,EAAD,IAAsBC,QAAQ,gBAA1D,SACC,cAAC,GAAD,Q,oICLSC,OAAKhN,WACHC,OACFA,O,oICCX,IAAMgN,EAAa3M,YAAO+L,IAAP/L,CAAH,KAIb,gBAAG4M,EAAH,EAAGA,YAAaC,EAAhB,EAAgBA,UAAhB,sBACCD,GAAe,2BADhB,iBAECC,GAAa,qCAFd,WAYG1B,EAA6B,SAAC,GAAD,IAClC2B,EADkC,EAClCA,SACAjL,EAFkC,EAElCA,WACAD,EAHkC,EAGlCA,SACGnB,EAJ+B,2DAMlC,cAACkM,EAAD,yBAAYC,YAAa/K,EAAYgL,UAAWjL,GAAcnB,GAA9D,aACEqM,MAKH3B,EAA2BxJ,aD1BN,CACpBE,YAAY,EACZD,UAAU,GC0BIuJ,S,8MClCf,IAQe4B,E,MARO/M,EAAOgN,KAAV,KAGhB,gBAAGpE,EAAH,EAAGA,MAAOqE,EAAV,EAAUA,WAAYC,EAAtB,EAAsBA,SAAtB,6BACQD,EADR,aACuBrE,EAAMjG,QAAQuK,GADrC,c,QCWGrB,GCVMC,IAAUpM,WAKZyN,IDKK,SAAC,GAAD,IAAGrB,EAAH,EAAGA,UAAWnJ,EAAd,EAAcA,QAAd,OACd,cAAC,EAAD,CACCsK,WAAYnB,EACZoB,SACqB,kBAAZvK,GAAwByK,SAASzK,EAAS,KAAQA,MAM7DkJ,EAAOlK,aCbc,CACpBgB,QAAS,GDcKkJ,S,6DEPA3E,IAjBU,WAAO,IAAD,EACDmG,cAAtBC,EADuB,oBAExB7K,EAAM8K,cAAeC,WAAW,iBAYtC,MAAO,CAAEA,WAXUC,YAA2BhL,EAAIiL,QAAQ,cAWrCzG,IATT,SAAA0G,GACNL,GAEL7K,EAAIwE,IAAI,CACP0G,QACAC,UAAW,IAAIC,W,iCCdlB,0GAEMC,EAAgC,4cAChCC,EAAwD,gfAGxDC,EAAW,CAChBC,SAAG,IACHC,OAAG,IACHC,SAAG,IACHC,OAAG,IACHC,SAAG,IACHC,OAAG,IACHC,SAAG,IACHC,OAAG,IACHC,SAAG,IACHC,OAAG,IACHC,SAAG,IACHC,OAAG,IACHC,SAAG,IACHC,OAAG,IACHC,SAAG,IACHC,OAAG,IACHC,SAAG,IACHC,OAAG,IACHC,SAAG,IACHC,OAAG,IACHC,OAAG,IACHC,SAAG,IACHC,SAAG,IACHC,SAAG,IACHC,SAAG,IACHC,SAAG,IACHC,SAAG,IACH,SAAK,KAIA9H,EAAuB,SAAArH,GAAI,OAChCA,EAAKoP,QAAQ9B,EAA+B,KACvC+B,EAA6C,SAAArP,GAAI,OACtDA,EAAKoP,QAAQ7B,EAAuD,KAC/D+B,EAAc,SAAAC,GAAM,OACzBA,EAAOH,QAAQ,yJAAmC,SAAAI,GAAK,OAAIhC,EAASgC,Q,sLCzC/DC,EAAO,SAACC,GAAD,IAAMlN,EAAN,uDAAa,GAAImN,EAAjB,uDAA4BC,IAA5B,OAAsCD,EAASF,KAAKC,EAAKlN,IAEhEqN,EAAM,SAACH,GAAwC,IAAnCI,EAAkC,uDAAzB,GAAIH,EAAqB,uDAAVC,IACzC,OAAOD,EAASE,IAAIH,EAAK,CACxBI,YAIIC,EAAM,SAACL,EAAKlN,GAAN,IAAYmN,EAAZ,uDAAuBC,IAAvB,OAAiCD,EAASI,IAAIL,EAAKlN,IAEzDwN,EAAS,SAACN,GAAD,IAAMC,EAAN,uDAAiBC,IAAjB,OAA2BD,EAASM,OAAOP,IAGpDQ,EAAK,uCAAG,WAAMC,GAAN,iBAAAjJ,EAAA,sEACUiJ,EADV,uBACLC,EADK,EACLA,KADK,kBAENA,GAFM,2CAAH,sDAMLC,EAAiBT,IAAMU,OAAO,CACnCC,QAASC,+BAGJC,EAAS,CACdhB,KAAM,sCAAIiB,EAAJ,yBAAIA,EAAJ,uBAAcjB,EAAI,WAAJ,EAAQiB,EAAR,QAAeL,MACnCR,IAAK,sCAAIa,EAAJ,yBAAIA,EAAJ,uBAAcb,EAAG,WAAH,EAAOa,EAAP,QAAcL,MACjCN,IAAK,sCAAIW,EAAJ,yBAAIA,EAAJ,uBAAcX,EAAG,WAAH,EAAOW,EAAP,QAAcL,MACjCJ,OAAQ,sCAAIS,EAAJ,yBAAIA,EAAJ,uBAAcV,EAAM,WAAN,EAAUU,EAAV,QAAiBL,Q,iCC7BxC,0GAAMM,EAA+B,SAAAvI,GAAK,MAAK,CAC9C4C,MAAO,IACP4F,OAAQ,IACR3F,QAAS,EACT4F,YAAazI,EAAME,QAAQwI,QAAQC,KACnCC,aAAc5I,EAAME,QAAQ2I,QAAQF,KAEpCG,oBAAqB,IACrBC,kBAAmB,IACnBC,aAAchJ,EAAME,QAAQtI,KAAK8Q,UAI5BpL,EAAc,CACnB2L,KAAM,OACNC,UAAW,WACXzL,KAAM,OACND,eAAgB,gBAChBD,8BAA+B,8BAG1B4L,EAAkB,CACvB5O,KAAM,IACN6O,mBAAoB,GACpBjQ,UAAU,EACVkE,UAAWC,EAAY2L,O,05BCpBlB7D,SAAW,CAChBC,SAAG,KACHC,OAAG,KACHC,SAAG,KACHC,OAAG,KACHC,SAAG,KACHC,OAAG,KACHC,SAAG,KACHC,OAAG,KACHC,SAAG,KACHC,OAAG,KACHC,SAAG,KACHC,OAAG,KACHC,SAAG,KACHC,OAAG,KACHC,SAAG,KACHC,OAAG,KACHC,SAAG,KACHC,OAAG,KACHC,SAAG,KACHC,OAAG,KACHC,OAAG,KACHC,SAAG,KACHC,SAAG,KACHC,SAAG,KACHC,SAAG,KACHC,SAAG,KACHC,SAAG,KACH,SAAK,MAGAsC,uBAAsB,yDACtBC,wBAA0B,OAG5BC,MACAC,WACAtP,OAAOuP,iBAAmBvP,OAAOwP,4BACpCH,MAAQrP,OAAOuP,gBACfD,UAAY,IAAIE,yBAChBF,UAAUG,MAAQ,EAClBH,UAAUI,KAAO,IAGlB,IAAMC,cAAa,0DACbC,yBAAwB,yEAqBxBC,6BAA+B,SAAA5C,GAAM,OAC1CA,EAAOH,QAAQ,yJAAmC,SAAAI,GAAK,OAAIhC,SAASgC,OAO/D4C,MAAQ,SAAApS,GACRA,IACA2R,OAAUC,WAOXD,MAAMU,UAAUV,MAAMW,SAGrBV,UAAUW,QACdX,UAAUW,MAAQZ,MAAMa,YAAYC,MAAK,SAAAlL,GAAC,MAAe,UAAXA,EAAEmL,SAEjDd,UAAU5R,KAAOA,EACjB2R,MAAMS,MAAMR,YAZXe,MAAM,6FAoBFC,uBAAsB,uUAAG,4MAAA1L,EAAA,uFACzB5E,OAAOuQ,qBADkB,8CAENhD,gDAAIqC,yBAA0B,CACpDY,QAAS,CACRC,OAAQ,aAJmB,gCAErB3C,KAFqB,WAErBA,KAKR9N,OAAOuQ,qBAAuBzC,KAAKhB,QAClC,mCACA,IAT4B,UAYzB9M,OAAO0Q,WAZkB,+CAcNnD,gDAAIoC,cAAe,CACzCa,QAAS,CACRC,OAAQ,aAhBmB,iCAcrB3C,MAdqB,YAcrBA,KAOR6C,KAAK7C,OArBwB,yDAAH,wDAgCtB1G,eAAc,oUAAG,WAAO3D,GAAP,6KAAAmB,EAAA,yDAAcqI,EAAd,+BAAuB,GACxCxJ,EADiB,oDAMlBmN,EAAU3D,EANQ,gCAQfqD,yBARe,OASrBM,EAAU5Q,OAAO0Q,WAAWG,UAAUpN,GATjB,cAWhBqN,EAAiBjB,6BAA6Be,GAC9CG,EACL5B,uBAAyB2B,EAAiB1B,wBAbrB,UAef4B,EAAQ,IAAIC,MAAMF,GAfH,UAgBfC,EAAME,OAhBS,2DAkBrB7J,QAAQ8J,KAAR,oFAEC,CACClE,OAAQ2D,EACRnN,QACAqN,iBACAC,aAGFjB,MAAMrM,GA3Be,2DAAH,uD,iCCvIpB,WAiBec,IAdK,SAAApF,GAGnB,IAAMQ,EAAMC,mBAQZ,OALAW,qBAAU,WACTZ,EAAIc,QAAUtB,IACZ,CAACA,IAGGQ,EAAIc,U,2GCXN2Q,EAAY,CACjB5J,SAAU6J,IAAQzU,WAClByD,KAAMgK,IAAezN,WACrBqC,SAAUpC,Q,QCFIyU,EAFDC,eAAKC,sBAAW,SAACpD,EAAOzO,GAAR,OAAgB,+CAASyO,GAAT,IAAgBzO,IAAKA,SCQ7Dd,GALKhC,OACJwN,IACCtN,SACEsN,IAEW,CACpBpL,UAAU,EACVoB,KAAM,IACN4H,MAAO,UACPwJ,QAAS,KCVJC,EAAWH,eAChBC,sBAAW,WAA2B7R,GAAS,IAAjCU,EAAgC,EAAhCA,KAAM4H,EAA0B,EAA1BA,MAAOwJ,EAAmB,EAAnBA,QACpBE,EAAa,SAAAvD,GAAK,OACvB,gDAAUA,GAAV,IAAiBwD,OAAQ3J,EAAO4J,cAAeJ,MAEhD,OACC,sBACCK,MAAM,6BACNpJ,MAAOrI,EACPiO,OAAQjO,EACRV,IAAKA,EAJN,UAMC,cAACgS,EAAD,CAAYI,GAAG,IAAIC,GAAG,IAAIC,GAAI5R,EAAM6R,GAAI7R,IACxC,cAACsR,EAAD,CAAYI,GAAI1R,EAAM2R,GAAG,IAAIC,GAAG,IAAIC,GAAI7R,IACxC,cAACsR,EAAD,CAAYI,GAAI1R,EAAO,EAAG2R,GAAG,IAAIC,GAAI5R,EAAO,EAAG6R,GAAI7R,IACnD,cAACsR,EAAD,CAAYI,GAAG,IAAIC,GAAI3R,EAAO,EAAG4R,GAAI5R,EAAM6R,GAAI7R,EAAO,WAO1DqR,EAAS7S,aAAeA,EAET6S,QCtBTS,EAAaZ,eAClBC,sBAAW,WAAwB7R,GAAS,IAA9BV,EAA6B,EAA7BA,SAAatB,EAAgB,4BACpCyU,EAAMnT,GAAYyS,GAAaJ,EACrC,OAAO,cAACc,EAAD,2BAAQzU,GAAR,IAAcgC,IAAKA,SAK5BwS,EAAWtT,aAAeA,EAEXsT,QCXTE,EAAQd,gBAAK,gBAAG/J,EAAH,EAAGA,SAAUnH,EAAb,EAAaA,KAAMpB,EAAnB,EAAmBA,SAAnB,OAClB,cAAC,EAAD,CAAYoB,KAAMA,EAAMpB,SAAUA,EAAUU,IAAK6H,OAGlD6K,EAAMjB,UAAYA,EAClBiB,EAAMxT,aLDe,CACpBI,UAAU,GKEIoT,Q,SCqGA7O,IA/FE,SAAC8O,GAA0C,IAA/BC,EAA8B,uDAApBtD,IAAoB,EAE9BrR,mBAAS2U,EAAQlS,MAAQ,KAFK,mBAEnDmS,EAFmD,KAE3CC,EAF2C,OAG9B7U,mBAAS,MAHqB,mBAGnD+F,EAHmD,KAG3C+O,EAH2C,KAIpD5M,EAAQhG,cAGR6S,EAAU/S,mBAEVgT,EAAa,WAAqD,IAApDC,EAAmD,uDAApCP,EAAWQ,EAAyB,uDAAZP,EACpDQ,EAAQ,uCACV9D,KACA6D,GAFU,IAGb5D,mBAAoB,CACnBxG,MAAOoK,EAAWpK,OAASoK,EAAWzS,KACtCiO,OAAQwE,EAAWxE,QAAUwE,EAAWzS,KACxC2S,aACET,GAAWtD,KAAiB9L,YAC7BC,IAAYE,eACb2P,eACEV,GAAWtD,KAAiB9L,YAC7BC,IAAYE,kBAMf,GAFIkP,IAAWO,EAAS1S,MAAMoS,EAAUM,EAAS1S,MAE7CsS,EAAQlS,QAAS,CAEhBkD,GACHgP,EAAQlS,QACNyS,iBAAkBX,EAAQtT,SAAY,UAAc,OACpDkU,SAAQ,SAAA5U,GAAC,OAAIA,EAAEmP,YAIlB,IAAM0F,EAAcC,IAAYrF,OAC/B2E,EAAQlS,QACRoS,EAFmB,2BAIfxE,YAA6BvI,IAC7BiN,EAAS7D,qBAIRoE,EAAgB,SAAhBA,IACLF,EAAYG,KAAK,CAChBC,WAAY,WACXC,YAAW,WACVH,MACE,UAMN,OADAZ,EAAUU,GACFN,EAAW3P,WAClB,KAAKC,IAAY2L,KAChBqE,EAAYM,yBACZ,MACD,KAAKtQ,IAAYG,KAGjB,KAAKH,IAAYC,8BAGjB,KAAKD,IAAYE,eAChBgQ,OAeJ,OALA/S,qBAAU,WACTqS,MAEE,IAEI,CACNnP,MACC,cAAC,EAAD,CACC+D,SAAUmL,EACVtS,KAAMmS,EACNvT,SAAUsT,EAAQtT,WAGpByE,QAASkP,EACTjP","file":"static/js/12.58c8f613.chunk.js","sourcesContent":["import { element, bool, objectOf, string } from 'prop-types';\r\n\r\nimport { icon } from 'components/types';\r\n\r\nconst propTypes = {\r\n\tcomponent: element.isRequired,\r\n\tpassDownOnCloseProp: bool,\r\n\tanchorOrigin: objectOf(string),\r\n\ttransformOrigin: objectOf(string),\r\n\ttooltip: string,\r\n\ttext: string,\r\n\ticon,\r\n};\r\n\r\nconst defaultProps = {\r\n\tpassDownOnCloseProp: false,\r\n\tanchorOrigin: {\r\n\t\tvertical: 'bottom',\r\n\t\thorizontal: 'center',\r\n\t},\r\n\ttransformOrigin: {\r\n\t\tvertical: 'top',\r\n\t\thorizontal: 'center',\r\n\t},\r\n\ttooltip: '',\r\n\ttext: null,\r\n\ticon: null,\r\n};\r\n\r\nexport { propTypes, defaultProps };\r\n","import React, { cloneElement, useState } from 'react';\r\nimport { Popover as MuiPopover } from '@material-ui/core';\r\nimport TooltipButton from 'components/TooltipButton';\r\nimport styled from 'styled-components';\r\n\r\nimport { propTypes, defaultProps } from './types';\r\n\r\nconst Wrapper = styled.div`\r\n\t&.MuiPopover-root {\r\n\t\tmargin: auto;\r\n\t\t// width: '3.5rem',\r\n\t\theight: 48px;\r\n\t\twidth: 48px;\r\n\r\n\t\tdisplay: inline-flex;\r\n\t\tposition: relative;\r\n\t\talign-items: center;\r\n\t\tvertical-align: middle;\r\n\t\t-moz-appearance: none;\r\n\t\tjustify-content: center;\r\n\t}\r\n\r\n\t& button {\r\n\t\tmargin: auto;\r\n\t}\r\n`;\r\n\r\nconst Popover = ({\r\n\tcomponent,\r\n\tanchorOrigin,\r\n\ttransformOrigin,\r\n\tpassDownOnCloseProp,\r\n\ttooltip,\r\n\ttext,\r\n\ticon,\r\n\t...rest\r\n}) => {\r\n\tconst [anchorEl, setAnchorEl] = useState(null);\r\n\r\n\tconst onClick = e => {\r\n\t\te.stopPropagation();\r\n\t\tsetAnchorEl(e.currentTarget);\r\n\t};\r\n\tconst onClose = () => {\r\n\t\tsetAnchorEl(null);\r\n\t};\r\n\r\n\tconst isPopoverOpen = Boolean(anchorEl);\r\n\tconst id = isPopoverOpen ? 'simple-popover' : undefined;\r\n\r\n\treturn (\r\n\t\t<Wrapper>\r\n\t\t\t<TooltipButton\r\n\t\t\t\taria-describedby={id}\r\n\t\t\t\ttooltip={tooltip}\r\n\t\t\t\tonClick={onClick}\r\n\t\t\t\ttext={text}\r\n\t\t\t\ticon={icon}\r\n\t\t\t/>\r\n\t\t\t<MuiPopover\r\n\t\t\t\tid={id}\r\n\t\t\t\topen={isPopoverOpen}\r\n\t\t\t\tanchorEl={anchorEl}\r\n\t\t\t\tonClose={onClose}\r\n\t\t\t\tanchorOrigin={anchorOrigin}\r\n\t\t\t\ttransformOrigin={transformOrigin}\r\n\t\t\t\t{...rest}\r\n\t\t\t>\r\n\t\t\t\t{(passDownOnCloseProp &&\r\n\t\t\t\t\tcloneElement(component, { popoverOnClose: onClose })) ||\r\n\t\t\t\t\tcomponent}\r\n\t\t\t</MuiPopover>\r\n\t\t</Wrapper>\r\n\t);\r\n};\r\n\r\nPopover.propTypes = propTypes;\r\nPopover.defaultProps = defaultProps;\r\n\r\nexport default Popover;\r\n","const PRACTICE_CONFIG = {\r\n\triceGrid: {\r\n\t\tlabel: 'Rice Grid (米)',\r\n\t\tvalue: true,\r\n\t},\r\n\tshuffle: {\r\n\t\tlabel: 'Shuffle',\r\n\t\tvalue: true,\r\n\t},\r\n\tcontinuous: {\r\n\t\tlabel: 'Continuous',\r\n\t\tvalue: true,\r\n\t},\r\n\tchallenge: {\r\n\t\tlabel: 'Challenge Mode',\r\n\t\tvalue: false,\r\n\t},\r\n\tautoPlay: {\r\n\t\tlabel: 'Autoplay sound',\r\n\t\tvalue: true,\r\n\t},\r\n\thighlightOnceOnChallengeMode: {\r\n\t\tlabel: 'Highlight once in Challenge Mode',\r\n\t\tvalue: true,\r\n\t},\r\n};\r\nconst MAX_SIZE = 350;\r\nconst PRACTICE_CONFIG_LOCAL_STORAGE_KEY = 'practiceConfig';\r\n\r\nconst ICON_SIZE = 'large';\r\n\r\nexport {\r\n\tPRACTICE_CONFIG,\r\n\tMAX_SIZE,\r\n\tPRACTICE_CONFIG_LOCAL_STORAGE_KEY,\r\n\tICON_SIZE,\r\n};\r\n","import { useEffect, useRef, useState } from 'react';\r\nimport { useTheme } from '@material-ui/core';\r\n\r\nimport { getSmallest } from 'utils/object';\r\nimport { MAX_SIZE } from './constants';\r\n\r\nconst useOnResize = () => {\r\n\tconst ref = useRef();\r\n\tconst { spacing } = useTheme();\r\n\tconst [size, setSize] = useState(\r\n\t\tgetSmallest(\r\n\t\t\twindow.document.body.clientWidth,\r\n\t\t\twindow.document.body.clientHeight,\r\n\t\t\tMAX_SIZE\r\n\t\t)\r\n\t);\r\n\r\n\tuseEffect(() => {\r\n\t\tconst handleResize = () => {\r\n\t\t\tif (ref.current) {\r\n\t\t\t\tconst _size =\r\n\t\t\t\t\tgetSmallest(\r\n\t\t\t\t\t\tref.current.clientWidth,\r\n\t\t\t\t\t\tref.current.clientHeight,\r\n\t\t\t\t\t\tMAX_SIZE\r\n\t\t\t\t\t) - spacing(5);\r\n\t\t\t\tsetSize(_size);\r\n\t\t\t}\r\n\t\t};\r\n\t\thandleResize();\r\n\t\twindow.addEventListener('resize', handleResize);\r\n\t\treturn () => {\r\n\t\t\twindow.removeEventListener('resize', handleResize);\r\n\t\t};\r\n\t}, [spacing]);\r\n\r\n\treturn {\r\n\t\tref,\r\n\t\tsize,\r\n\t};\r\n};\r\n\r\nexport default useOnResize;\r\n","import loadable from 'utils/loadable';\r\n\r\nexport default loadable(() => import('./index'), 'small');\r\n","import React, { useCallback, useMemo, useState } from 'react';\r\n\r\nimport LazySwitch from 'components/Switch/Lazy';\r\n\r\nconst generateSwitchList = (state, onCheck) =>\r\n\tObject.keys(state).map(key => {\r\n\t\tconst { value, label } = state[key];\r\n\t\treturn (\r\n\t\t\t<LazySwitch\r\n\t\t\t\tkey={key}\r\n\t\t\t\tname={key}\r\n\t\t\t\tlabel={label}\r\n\t\t\t\tchecked={value}\r\n\t\t\t\tonCheck={onCheck}\r\n\t\t\t/>\r\n\t\t);\r\n\t});\r\n\r\nconst useSwitches = (initialState, cb = null) => {\r\n\tconst [switches, setSwitches] = useState(initialState);\r\n\r\n\tconst onCheck = useCallback(\r\n\t\t(key, value) => {\r\n\t\t\tsetSwitches(prev => {\r\n\t\t\t\tconst newValues = {\r\n\t\t\t\t\t...prev,\r\n\t\t\t\t\t[key]: {\r\n\t\t\t\t\t\t...prev[key],\r\n\t\t\t\t\t\tvalue,\r\n\t\t\t\t\t},\r\n\t\t\t\t};\r\n\t\t\t\tcb?.(newValues);\r\n\r\n\t\t\t\treturn newValues;\r\n\t\t\t});\r\n\t\t},\r\n\t\t[cb]\r\n\t);\r\n\r\n\tconst switchList = useMemo(() => generateSwitchList(switches, onCheck), [\r\n\t\tswitches,\r\n\t\tonCheck,\r\n\t]);\r\n\r\n\treturn {\r\n\t\tswitches: Object.keys(switches).reduce(\r\n\t\t\t(acc, key) => ({\r\n\t\t\t\t...acc,\r\n\t\t\t\t[key]: switches[key].value,\r\n\t\t\t}),\r\n\t\t\t{}\r\n\t\t),\r\n\t\tsetSwitches,\r\n\t\tonCheck,\r\n\t\tswitchList,\r\n\t};\r\n};\r\n\r\nexport default useSwitches;\r\n","import useLocalStorage from 'hooks/useLocalStorage';\r\nimport useSwitches from 'hooks/useSwitches';\r\nimport {\r\n\tPRACTICE_CONFIG,\r\n\tPRACTICE_CONFIG_LOCAL_STORAGE_KEY,\r\n} from './constants';\r\n\r\nconst useSwitchesWithPersistedConfig = () => {\r\n\tconst [practiceConfig, setPracticeConfig] = useLocalStorage(\r\n\t\tPRACTICE_CONFIG_LOCAL_STORAGE_KEY,\r\n\t\tPRACTICE_CONFIG\r\n\t);\r\n\r\n\treturn useSwitches(practiceConfig, setPracticeConfig);\r\n};\r\n\r\nexport default useSwitchesWithPersistedConfig;\r\n","import { useRef } from 'react';\r\n\r\nconst useIsFirstMount = () => {\r\n\tconst firstMount = useRef(true);\r\n\r\n\tif (firstMount.current) {\r\n\t\tfirstMount.current = false;\r\n\r\n\t\treturn true;\r\n\t}\r\n\r\n\treturn firstMount.current;\r\n};\r\n\r\nexport default useIsFirstMount;\r\n","import { useEffect } from 'react';\r\n\r\nimport useIsFirstMount from './useIsFirstMount';\r\n\r\nconst useEffectOnUpdate = (effect, dependencies, cleanup) => {\r\n\tconst isFirstMount = useIsFirstMount();\r\n\r\n\tuseEffect(() => {\r\n\t\tif (!isFirstMount) effect();\r\n\t\treturn cleanup;\r\n\r\n\t\t// eslint-disable-next-line react-hooks/exhaustive-deps\r\n\t}, dependencies);\r\n};\r\n\r\nexport default useEffectOnUpdate;\r\n","import { useEffect } from 'react';\r\n\r\nimport useHanzi from 'components/Hanzi/useHanzi';\r\nimport { START_MODES } from 'components/Hanzi/constants';\r\nimport useEffectOnUpdate from 'hooks/useEffectOnUpdate';\r\n\r\nconst useHanziWriter = ({ size, characters, index, switches }) => {\r\n\tconst { riceGrid, challenge, highlightOnceOnChallengeMode } = switches;\r\n\r\n\tconst writeConfig = {\r\n\t\tsize,\r\n\t\triceGrid,\r\n\t\tstartMode:\r\n\t\t\t(highlightOnceOnChallengeMode &&\r\n\t\t\t\tSTART_MODES.QUIZ_CHALLENGE_HIGHLIGHT_ONCE) ||\r\n\t\t\t(challenge && START_MODES.QUIZ_CHALLENGE) ||\r\n\t\t\tSTART_MODES.QUIZ,\r\n\t};\r\n\r\n\tconst { hanzi, rewrite, writer } = useHanzi(characters[index], writeConfig);\r\n\r\n\tconst rewriteHanzi = () => {\r\n\t\trewrite(characters[index], writeConfig);\r\n\t};\r\n\r\n\tuseEffectOnUpdate(() => {\r\n\t\trewriteHanzi();\r\n\t}, [riceGrid, size, index, characters]);\r\n\r\n\tuseEffect(() => {\r\n\t\twriter?.[`${(challenge && 'hide') || 'show'}Outline`]();\r\n\t}, [writer, challenge]);\r\n\r\n\treturn {\r\n\t\thanzi,\r\n\t};\r\n};\r\n\r\nexport default useHanziWriter;\r\n","import { useState } from 'react';\r\n\r\nconst useInput = (initialValue = '') => {\r\n\tconst [input, setInput] = useState(initialValue);\r\n\r\n\tconst onChange = e => setInput(e.target.value);\r\n\r\n\treturn {\r\n\t\tinput,\r\n\t\tsetInput,\r\n\t\tonChange,\r\n\t};\r\n};\r\n\r\nexport default useInput;\r\n","import { useEffect, useState } from 'react';\r\n\r\nimport useInput from 'hooks/useInput';\r\nimport { shuffleArray } from 'utils/object';\r\nimport { stripNonChineseChars } from 'utils/chinese';\r\nimport usePrevious from 'hooks/usePrevious';\r\nimport useSearchQueries from 'store/firebase/hooks/useSearchQueries';\r\n\r\nconst useInputWithCharacterList = (initialValue, shuffle, label) => {\r\n\tconst { add } = useSearchQueries();\r\n\tconst { input, setInput, onChange, ...rest } = useInput(initialValue);\r\n\tconst [characters, setCharacters] = useState([]);\r\n\tconst previousHanzi = usePrevious(input);\r\n\r\n\tconst getCharacterList = (text = input) =>\r\n\t\t(shuffle && shuffleArray(text)) || text.split('');\r\n\r\n\tconst restart = () => {\r\n\t\tsetCharacters(v => getCharacterList((shuffle && v) || input));\r\n\t};\r\n\r\n\tconst onSubmit = async e => {\r\n\t\te.preventDefault();\r\n\r\n\t\tconst currentHanzi = stripNonChineseChars(input);\r\n\t\t// Filter out non-hanzi characters from the input\r\n\t\tif (stripNonChineseChars(previousHanzi) === currentHanzi) {\r\n\t\t\tif (previousHanzi !== input) setInput(currentHanzi);\r\n\t\t\tif (!currentHanzi) setCharacters([]);\r\n\t\t\treturn;\r\n\t\t}\r\n\r\n\t\tif (currentHanzi) {\r\n\t\t\tadd(currentHanzi);\r\n\t\t\tsetInput(currentHanzi);\r\n\t\t\tsetCharacters(getCharacterList(currentHanzi));\r\n\t\t\treturn;\r\n\t\t}\r\n\r\n\t\t// If all non-hanzi characters, reset to empty\r\n\t\tsetCharacters([]);\r\n\t\tsetInput('');\r\n\t};\r\n\r\n\tuseEffect(() => {\r\n\t\tsetCharacters(getCharacterList());\r\n\t\t// eslint-disable-next-line react-hooks/exhaustive-deps\r\n\t}, []);\r\n\r\n\treturn {\r\n\t\tcharacters,\r\n\t\tinput,\r\n\t\trestart,\r\n\t\tonChange,\r\n\t\tonSubmit,\r\n\t\tlabel,\r\n\t\t...rest,\r\n\t};\r\n};\r\n\r\nexport default useInputWithCharacterList;\r\n","import { useState } from 'react';\r\n\r\nimport useEffectOnUpdate from 'hooks/useEffectOnUpdate';\r\n\r\nconst useIndex = (input, restartDependencyArray, restartCallback = null) => {\r\n\tconst [index, setIndex] = useState(0);\r\n\tconst isPreviousDisabled = index === 0;\r\n\tconst isNextDisabled = index + 1 === input.length;\r\n\tconst onPrevious = () => setIndex(v => v - 1);\r\n\tconst onNext = () => setIndex(v => v + 1);\r\n\tconst onRestart = () => {\r\n\t\tsetIndex(0);\r\n\t\trestartCallback?.();\r\n\t};\r\n\r\n\tuseEffectOnUpdate(() => {\r\n\t\tonRestart();\r\n\t}, restartDependencyArray);\r\n\r\n\treturn {\r\n\t\tindex,\r\n\t\tisPreviousDisabled,\r\n\t\tisNextDisabled,\r\n\t\tonPrevious,\r\n\t\tonNext,\r\n\t\tonRestart,\r\n\t};\r\n};\r\n\r\nexport default useIndex;\r\n","import React, { useEffect, useState } from 'react';\r\nimport {\r\n\tBox,\r\n\tGrid,\r\n\tInputAdornment,\r\n\tPaper,\r\n\tTextField,\r\n\tuseMediaQuery,\r\n} from '@material-ui/core';\r\nimport styled from 'styled-components';\r\n\r\nimport ContainerWithCenteredItems from 'components/ContainerWithCenteredItems';\r\nimport PageContainer from 'routes/PageContainer';\r\nimport TooltipButton from 'components/TooltipButton';\r\nimport {\r\n\tPreviousIcon,\r\n\tNextIcon,\r\n\tSubmitIcon,\r\n\tReplayIcon,\r\n\tSettingsIcon,\r\n\tSpeakIcon,\r\n} from 'icons';\r\nimport Spacer from 'components/Spacer';\r\nimport Popover from 'components/Popover';\r\nimport { trySpeakNative } from 'utils/speech';\r\nimport useOnResize from './useOnResize';\r\nimport useSwitchesWithPersistedConfig from './useSwitchesWithPersistedConfig';\r\nimport useHanziWriter from './useHanziWriter';\r\nimport useInputWithCharacterList from './useInputWithCharacterList';\r\nimport useIndex from './useIndex';\r\nimport { ICON_SIZE } from './constants';\r\n\r\nconst StyledPaper = styled(Paper)`\r\n\t${({ theme, $size }) => `\r\n\t\tposition: relative;\r\n\t\tbackground-color: ${theme.palette.background.level2};\r\n\t\tpadding: ${theme.spacing(2)}px;\r\n\t\t${($size && `width: ${$size}px`) || ''}\r\n\t`}\r\n`;\r\n\r\nconst StyledTooltipButton = styled(TooltipButton)`\r\n\tposition: absolute;\r\n\ttop: 0;\r\n\tright: 0;\r\n`;\r\n\r\nconst Practice = () => {\r\n\tconst smAndDown = useMediaQuery(theme => theme.breakpoints.down('sm'));\r\n\tconst [pendingSpeechScraper, setPendingSpeechScraper] = useState(false);\r\n\r\n\tconst { ref: pageRef, size } = useOnResize();\r\n\tconst { switches, switchList } = useSwitchesWithPersistedConfig();\r\n\tconst {\r\n\t\tcharacters,\r\n\t\trestart,\r\n\t\tinput,\r\n\t\tonSubmit,\r\n\t\t...textFieldProps\r\n\t} = useInputWithCharacterList('', switches.shuffle, 'Enter hanzi(s)');\r\n\r\n\tconst {\r\n\t\tindex,\r\n\t\tisPreviousDisabled,\r\n\t\tisNextDisabled,\r\n\t\tonPrevious,\r\n\t\tonNext,\r\n\t\tonRestart,\r\n\t} = useIndex(input, [switches.shuffle], restart);\r\n\r\n\tconst { hanzi } = useHanziWriter({\r\n\t\tsize,\r\n\t\tcharacters,\r\n\t\tindex,\r\n\t\tswitches,\r\n\t});\r\n\r\n\tconst getOrder = order => ({\r\n\t\tstyle: {\r\n\t\t\torder,\r\n\t\t},\r\n\t});\r\n\r\n\tconst _switchList = switchList.map((switchComponent, ind) => (\r\n\t\t<div key={ind}>\r\n\t\t\t{switchComponent}\r\n\t\t\t<br />\r\n\t\t</div>\r\n\t));\r\n\r\n\tconst onSpeak = async () => {\r\n\t\ttry {\r\n\t\t\tsetPendingSpeechScraper(true);\r\n\t\t\tawait trySpeakNative(characters[index]);\r\n\t\t} catch (err) {\r\n\t\t\tconsole.error('Failed to speak');\r\n\t\t} finally {\r\n\t\t\tsetPendingSpeechScraper(false);\r\n\t\t}\r\n\t};\r\n\r\n\t// If autoPlay is enabled, speak automatically on new character\r\n\tuseEffect(() => {\r\n\t\tif (switches.autoPlay) onSpeak();\r\n\t\t// eslint-disable-next-line react-hooks/exhaustive-deps\r\n\t}, [index]);\r\n\r\n\treturn (\r\n\t\t<PageContainer innerRef={pageRef}>\r\n\t\t\t{/* INPUT BOX */}\r\n\t\t\t<form onSubmit={onSubmit}>\r\n\t\t\t\t<TextField\r\n\t\t\t\t\tvalue={input}\r\n\t\t\t\t\tvariant=\"outlined\"\r\n\t\t\t\t\ttype=\"search\"\r\n\t\t\t\t\tInputProps={{\r\n\t\t\t\t\t\tendAdornment: (\r\n\t\t\t\t\t\t\t<InputAdornment position=\"start\">\r\n\t\t\t\t\t\t\t\t<>\r\n\t\t\t\t\t\t\t\t\t<TooltipButton\r\n\t\t\t\t\t\t\t\t\t\ttooltip=\"Search\"\r\n\t\t\t\t\t\t\t\t\t\tdisabled={!input}\r\n\t\t\t\t\t\t\t\t\t\tcolor=\"primary\"\r\n\t\t\t\t\t\t\t\t\t\ticon={SubmitIcon}\r\n\t\t\t\t\t\t\t\t\t\ticonSize=\"small\"\r\n\t\t\t\t\t\t\t\t\t\ttype=\"submit\"\r\n\t\t\t\t\t\t\t\t\t/>\r\n\t\t\t\t\t\t\t\t\t{smAndDown && (\r\n\t\t\t\t\t\t\t\t\t\t<Popover\r\n\t\t\t\t\t\t\t\t\t\t\ticon={\r\n\t\t\t\t\t\t\t\t\t\t\t\t// eslint-disable-next-line max-len\r\n\t\t\t\t\t\t\t\t\t\t\t\t<SettingsIcon fontSize=\"small\" />\r\n\t\t\t\t\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t\t\t\t\tcomponent={\r\n\t\t\t\t\t\t\t\t\t\t\t\t<StyledPaper $size={350}>\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t{_switchList}\r\n\t\t\t\t\t\t\t\t\t\t\t\t</StyledPaper>\r\n\t\t\t\t\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t\t\t\t/>\r\n\t\t\t\t\t\t\t\t\t)}\r\n\t\t\t\t\t\t\t\t</>\r\n\t\t\t\t\t\t\t</InputAdornment>\r\n\t\t\t\t\t\t),\r\n\t\t\t\t\t}}\r\n\t\t\t\t\t{...textFieldProps}\r\n\t\t\t\t/>\r\n\t\t\t</form>\r\n\t\t\t{/* CONFIGURATION */}\r\n\t\t\t{!smAndDown && (\r\n\t\t\t\t<ContainerWithCenteredItems container alignItems=\"center\">\r\n\t\t\t\t\t<Paper elevation={3}>\r\n\t\t\t\t\t\t<Box width={350} padding={2} textAlign=\"left\">\r\n\t\t\t\t\t\t\t{_switchList}\r\n\t\t\t\t\t\t</Box>\r\n\t\t\t\t\t</Paper>\r\n\t\t\t\t</ContainerWithCenteredItems>\r\n\t\t\t)}\r\n\t\t\t{/* HANZI */}\r\n\t\t\t{!!characters.length && (\r\n\t\t\t\t<ContainerWithCenteredItems\r\n\t\t\t\t\tcontainer\r\n\t\t\t\t\talignItems=\"center\"\r\n\t\t\t\t\tjustify=\"space-between\"\r\n\t\t\t\t>\r\n\t\t\t\t\t{/* LEFT BUTTON */}\r\n\t\t\t\t\t<div {...getOrder(2)}>\r\n\t\t\t\t\t\t<TooltipButton\r\n\t\t\t\t\t\t\ttooltip=\"Previous\"\r\n\t\t\t\t\t\t\ticon={PreviousIcon}\r\n\t\t\t\t\t\t\ticonSize={ICON_SIZE}\r\n\t\t\t\t\t\t\tonClick={onPrevious}\r\n\t\t\t\t\t\t\tdisabled={isPreviousDisabled}\r\n\t\t\t\t\t\t/>\r\n\t\t\t\t\t\t<Spacer order=\"1\" direction=\"right\" spacing=\"10\" />\r\n\t\t\t\t\t</div>\r\n\t\t\t\t\t{/* DRAWING */}\r\n\t\t\t\t\t<Grid\r\n\t\t\t\t\t\t{...(smAndDown && {\r\n\t\t\t\t\t\t\tcontainer: true,\r\n\t\t\t\t\t\t\tjustify: 'center',\r\n\t\t\t\t\t\t})}\r\n\t\t\t\t\t\titem\r\n\t\t\t\t\t\txs={12}\r\n\t\t\t\t\t\tmd=\"auto\"\r\n\t\t\t\t\t\t{...getOrder((smAndDown && 1) || 3)}\r\n\t\t\t\t\t>\r\n\t\t\t\t\t\t<StyledPaper elevation={3}>\r\n\t\t\t\t\t\t\t<StyledTooltipButton\r\n\t\t\t\t\t\t\t\ttooltip=\"Speak\"\r\n\t\t\t\t\t\t\t\tonClick={onSpeak}\r\n\t\t\t\t\t\t\t\tdisabled={!input}\r\n\t\t\t\t\t\t\t\tloading={pendingSpeechScraper}\r\n\t\t\t\t\t\t\t\ticonSize={ICON_SIZE}\r\n\t\t\t\t\t\t\t\ticon={SpeakIcon}\r\n\t\t\t\t\t\t\t/>\r\n\t\t\t\t\t\t\t{hanzi}\r\n\t\t\t\t\t\t</StyledPaper>\r\n\t\t\t\t\t</Grid>\r\n\t\t\t\t\t{/* RIGHT BUTTON */}\r\n\t\t\t\t\t<div {...getOrder(4)}>\r\n\t\t\t\t\t\t<Spacer order=\"2\" direction=\"left\" spacing=\"10\" />\r\n\t\t\t\t\t\t{((!isNextDisabled || !switches.continuous) && (\r\n\t\t\t\t\t\t\t<TooltipButton\r\n\t\t\t\t\t\t\t\ttooltip=\"Next\"\r\n\t\t\t\t\t\t\t\ticon={NextIcon}\r\n\t\t\t\t\t\t\t\ticonSize={ICON_SIZE}\r\n\t\t\t\t\t\t\t\tonClick={onNext}\r\n\t\t\t\t\t\t\t\tdisabled={isNextDisabled}\r\n\t\t\t\t\t\t\t/>\r\n\t\t\t\t\t\t)) || (\r\n\t\t\t\t\t\t\t<TooltipButton\r\n\t\t\t\t\t\t\t\ttooltip=\"Restart\"\r\n\t\t\t\t\t\t\t\ticon={ReplayIcon}\r\n\t\t\t\t\t\t\t\ticonSize={ICON_SIZE}\r\n\t\t\t\t\t\t\t\tonClick={onRestart}\r\n\t\t\t\t\t\t\t/>\r\n\t\t\t\t\t\t)}\r\n\t\t\t\t\t</div>\r\n\t\t\t\t</ContainerWithCenteredItems>\r\n\t\t\t)}\r\n\t\t</PageContainer>\r\n\t);\r\n};\r\n\r\nexport default Practice;\r\n","import React from 'react';\r\nimport { SuspenseWithPerf } from 'reactfire';\r\n\r\nimport PracticeContainer from 'containers/Practice';\r\nimport LoadingIndicator from 'components/LoadingIndicator';\r\n\r\nconst Practice = () => (\r\n\t<SuspenseWithPerf fallback={<LoadingIndicator />} traceId=\"load-practice\">\r\n\t\t<PracticeContainer />\r\n\t</SuspenseWithPerf>\r\n);\r\n\r\nexport default Practice;\r\n","import { bool, node } from 'prop-types';\r\n\r\nconst propTypes = {\r\n\tchildren: node.isRequired,\r\n\thorizontal: bool,\r\n\tvertical: bool,\r\n};\r\n\r\nconst defaultProps = {\r\n\thorizontal: true,\r\n\tvertical: false,\r\n};\r\n\r\nexport { propTypes, defaultProps };\r\n","import React from 'react';\r\nimport styled from 'styled-components';\r\nimport { Grid } from '@material-ui/core';\r\n\r\nimport { propTypes, defaultProps } from './types';\r\n\r\nconst StyledGrid = styled(Grid)`\r\n\twidth: 100%;\r\n\tdisplay: flex;\r\n\tflex-wrap: wrap;\r\n\t${({ $horizontal, $vertical }) => `\r\n\t\t${$horizontal && 'justify-content: center;'}\r\n\t\t${$vertical && 'height: 100%; align-items: center;'}\r\n\t`}\r\n`;\r\n\r\n/**\r\n * Centered Grid\r\n *\r\n * @component\r\n * @param {import('@material-ui/core').GridProps|import('react').HtmlHTMLAttributes}\r\n */\r\nconst ContainerWithCenteredItems = ({\r\n\tchildren,\r\n\thorizontal,\r\n\tvertical,\r\n\t...rest\r\n}) => (\r\n\t<StyledGrid $horizontal={horizontal} $vertical={vertical} {...rest}>\r\n\t\t{children}\r\n\t</StyledGrid>\r\n);\r\n\r\nContainerWithCenteredItems.propTypes = propTypes;\r\nContainerWithCenteredItems.defaultProps = defaultProps;\r\n\r\nexport default ContainerWithCenteredItems;\r\n","import styled from 'styled-components';\r\n\r\nconst StyledWrapper = styled.span`\r\n\tdisplay: block;\r\n\twidth: 100%;\r\n\t${({ theme, $direction, $spacing }) => `\r\n\t\tmargin-${$direction}: ${theme.spacing($spacing)}px;\r\n\t`}\r\n`;\r\n\r\nexport default StyledWrapper;\r\n","import React from 'react';\r\nimport StyledWrapper from './StyledWrapper';\r\nimport { defaultProps, propTypes } from './types';\r\n\r\n/**\r\n * Element that adds margin to the given direction based on the\r\n * spacing amount. The amount is passed in to the spacing method\r\n * of Mui. By default 1-unit-spacing = 8px\r\n *\r\n * @example\r\n * ```js\r\n * <Spacer direction=\"right\" spacing=\"5\" />\r\n * ```\r\n *\r\n * @component\r\n */\r\nconst Spacer = ({ direction, spacing }) => (\r\n\t<StyledWrapper\r\n\t\t$direction={direction}\r\n\t\t$spacing={\r\n\t\t\t(typeof spacing === 'string' && parseInt(spacing, 10)) || spacing\r\n\t\t}\r\n\t/>\r\n);\r\n\r\nSpacer.propTypes = propTypes;\r\nSpacer.defaultProps = defaultProps;\r\n\r\nexport default Spacer;\r\n","import { direction, numberOrString } from 'components/types';\r\n\r\nconst propTypes = {\r\n\t/**\r\n\t * - Which direction do you want to apply margin to\r\n\t */\r\n\tdirection: direction.isRequired,\r\n\t/**\r\n\t * - The amount is passed in to the spacing method of Mui.\r\n\t * - By default 1-unit-spacing = 8px\r\n\t */\r\n\tspacing: numberOrString,\r\n};\r\nconst defaultProps = {\r\n\tspacing: 1,\r\n};\r\n\r\nexport { propTypes, defaultProps };\r\n","import { useFirestore, useFirestoreCollectionData } from 'reactfire';\r\n\r\nimport useIsAnalyticsEnabled from 'hooks/useIsAnalyticsEnabled';\r\n\r\nconst useSearchQueries = () => {\r\n\tconst [analyticsIsEnabled] = useIsAnalyticsEnabled();\r\n\tconst ref = useFirestore().collection('searchQueries');\r\n\tconst collection = useFirestoreCollectionData(ref.orderBy('createdOn'));\r\n\r\n\tconst add = query => {\r\n\t\tif (!analyticsIsEnabled) return;\r\n\r\n\t\tref.add({\r\n\t\t\tquery,\r\n\t\t\tcreatedOn: new Date(),\r\n\t\t});\r\n\t};\r\n\r\n\treturn { collection, add };\r\n};\r\n\r\nexport default useSearchQueries;\r\n","const REGEX_CHINESE = /\\p{Script=Han}/u;\r\nconst REGEX_PINYIN = /<td class=\"hanzi5-article-hanzi-info-td2\">(.*)<\\/td>/;\r\nconst REGEX_STRIP_NON_CHINESE_CHARS = /[^\\p{Script=Han}]+/gu;\r\nconst REGEX_STRIP_NON_CHINESE_AND_NON_SET_PUNCTUATION_CHARS = /[^\\p{Script=Han},.?!，、。？！]+/gu;\r\n\r\n/** @see https://github.com/sxei/pinyinjs/blob/3f0013841ba62a6d1af38e50839ea196b27369cb/pinyinUtil.js#L16 */\r\nconst TONE_MAP = {\r\n\tā: 'a',\r\n\tá: 'a',\r\n\tǎ: 'a',\r\n\tà: 'a',\r\n\tō: 'o',\r\n\tó: 'o',\r\n\tǒ: 'o',\r\n\tò: 'o',\r\n\tē: 'e',\r\n\té: 'e',\r\n\tě: 'e',\r\n\tè: 'e',\r\n\tī: 'i',\r\n\tí: 'i',\r\n\tǐ: 'i',\r\n\tì: 'i',\r\n\tū: 'u',\r\n\tú: 'u',\r\n\tǔ: 'u',\r\n\tù: 'u',\r\n\tü: 'v',\r\n\tǖ: 'v',\r\n\tǘ: 'v',\r\n\tǚ: 'v',\r\n\tǜ: 'v',\r\n\tń: 'n',\r\n\tň: 'n',\r\n\t'': 'm',\r\n};\r\n\r\nconst isChinese = text => REGEX_CHINESE.test(text);\r\nconst stripNonChineseChars = text =>\r\n\ttext.replace(REGEX_STRIP_NON_CHINESE_CHARS, '');\r\nconst stripNonChineseAndNonSetPunctionationChars = text =>\r\n\ttext.replace(REGEX_STRIP_NON_CHINESE_AND_NON_SET_PUNCTUATION_CHARS, '');\r\nconst removeTones = pinyin =>\r\n\tpinyin.replace(/[āáǎàōóǒòēéěèīíǐìūúǔùüǖǘǚǜńň]/g, match => TONE_MAP[match]);\r\n\r\nexport {\r\n\tREGEX_CHINESE,\r\n\tREGEX_PINYIN,\r\n\tREGEX_STRIP_NON_CHINESE_CHARS,\r\n\tREGEX_STRIP_NON_CHINESE_AND_NON_SET_PUNCTUATION_CHARS,\r\n\tisChinese,\r\n\tstripNonChineseChars,\r\n\tstripNonChineseAndNonSetPunctionationChars,\r\n\tremoveTones,\r\n};\r\n","import axios from 'axios';\r\n\r\nconst post = (url, body = {}, instance = axios) => instance.post(url, body);\r\n\r\nconst get = (url, params = {}, instance = axios) => {\r\n\treturn instance.get(url, {\r\n\t\tparams,\r\n\t});\r\n};\r\n\r\nconst put = (url, body, instance = axios) => instance.put(url, body);\r\n\r\nconst remove = (url, instance = axios) => instance.delete(url);\r\n\r\n// https://github.com/axios/axios#response-schema\r\nconst parse = async res => {\r\n\tconst { data } = await res;\r\n\treturn data;\r\n};\r\n\r\n// Set config defaults when creating the instance\r\nconst serverInstance = axios.create({\r\n\tbaseURL: process.env.REACT_APP_SERVER_URI,\r\n});\r\n\r\nconst server = {\r\n\tpost: (...props) => post(...props, serverInstance),\r\n\tget: (...props) => get(...props, serverInstance),\r\n\tput: (...props) => put(...props, serverInstance),\r\n\tdelete: (...props) => remove(...props, serverInstance),\r\n};\r\n\r\nexport { post, get, put, remove as delete, parse, server };\r\n","const getDefaultHanziWriterOptions = theme => ({\r\n\twidth: 150,\r\n\theight: 150,\r\n\tpadding: 5,\r\n\tstrokeColor: theme.palette.primary.main,\r\n\tradicalColor: theme.palette.success.main,\r\n\t// strokeAnimationSpeed: 1,\r\n\tdelayBetweenStrokes: 200,\r\n\tdelayBetweenLoops: 500,\r\n\tdrawingColor: theme.palette.text.primary,\r\n\t// drawingWidth: 25,\r\n});\r\n\r\nconst START_MODES = {\r\n\tLOOP: 'loop',\r\n\tDRAW_ONCE: 'drawOnce',\r\n\tQUIZ: 'quiz',\r\n\tQUIZ_CHALLENGE: 'quizChallenge',\r\n\tQUIZ_CHALLENGE_HIGHLIGHT_ONCE: 'quizChallengeHighlightOnce',\r\n};\r\n\r\nconst DEFAULT_OPTIONS = {\r\n\tsize: 150,\r\n\thanziWriterOptions: {},\r\n\triceGrid: true,\r\n\tstartMode: START_MODES.LOOP,\r\n};\r\n\r\nexport { getDefaultHanziWriterOptions, START_MODES, DEFAULT_OPTIONS };\r\n","// #region CONSTANTS\r\n\r\nimport { get } from 'api/rest';\r\n\r\n/** @see https://github.com/sxei/pinyinjs/blob/3f0013841ba62a6d1af38e50839ea196b27369cb/pinyinUtil.js#L16 */\r\nconst TONE_MAP = {\r\n\tā: 'a1',\r\n\tá: 'a2',\r\n\tǎ: 'a3',\r\n\tà: 'a4',\r\n\tō: 'o1',\r\n\tó: 'o2',\r\n\tǒ: 'o3',\r\n\tò: 'o4',\r\n\tē: 'e1',\r\n\té: 'e2',\r\n\tě: 'e3',\r\n\tè: 'e4',\r\n\tī: 'i1',\r\n\tí: 'i2',\r\n\tǐ: 'i3',\r\n\tì: 'i4',\r\n\tū: 'u1',\r\n\tú: 'u2',\r\n\tǔ: 'u3',\r\n\tù: 'u4',\r\n\tü: 'v0',\r\n\tǖ: 'v1',\r\n\tǘ: 'v2',\r\n\tǚ: 'v3',\r\n\tǜ: 'v4',\r\n\tń: 'n2',\r\n\tň: 'n3',\r\n\t'': 'm2',\r\n};\r\n\r\nconst HAN_TRAINER_PRO_PREFIX = `https://www.hantrainerpro.de/resources/pronunciations/`;\r\nconst HAN_TRAINER_PRO_POSTFIX = '.mp3';\r\n\r\n// Don't recreate these on each speak\r\nlet synth;\r\nlet utterance;\r\nif (window.speechSynthesis || window.SpeechSynthesisUtterance) {\r\n\tsynth = window.speechSynthesis;\r\n\tutterance = new SpeechSynthesisUtterance();\r\n\tutterance.pitch = 1;\r\n\tutterance.rate = 0.8;\r\n}\r\n\r\nconst PINYIN_JS_URL = `https://cdn.jsdelivr.net/gh/sxei/pinyinjs/pinyinUtil.js`;\r\nconst PINYIN_JS_DICTIONARY_URL = `https://cdn.jsdelivr.net/gh/sxei/pinyinjs/dict/pinyin_dict_withtone.js`;\r\n\r\n// #endregion\r\n\r\n/**\r\n * HanTrainerPro uses direct mark to tone conversion, so we need to\r\n * parse single tone marks to their respective numbered tones.\r\n * - As an example, for hǎo:\r\n * \t- We would normally want hao3\r\n * \t\t- @see https://hantrainerpro.de/resources/pronunciations/hao3.mp3 (Error)\r\n * \t- But the api works with ha3o\r\n * \t\t- @see https://hantrainerpro.de/resources/pronunciations/ha3o.mp3 (Working)\r\n *\r\n * @see https://github.com/sxei/pinyinjs/blob/3f0013841ba62a6d1af38e50839ea196b27369cb/pinyinUtil.js#L260 (Algorithm)\r\n *\r\n * @example\r\n * markToNumberForHanTrainerPro(hǎo);\r\n * // returns ha3o\r\n *\r\n * @param {String} pinyin Pinyin to parse\r\n */\r\nconst markToNumberForHanTrainerPro = pinyin =>\r\n\tpinyin.replace(/[āáǎàōóǒòēéěèīíǐìūúǔùüǖǘǚǜńň]/g, match => TONE_MAP[match]);\r\n\r\n/**\r\n * Speaks the given word using SpeechSynthesisUtterance\r\n *\r\n * @param {String} text Hanzi to speak.\r\n */\r\nconst speak = text => {\r\n\tif (!text) return;\r\n\tif (!synth || !utterance) {\r\n\t\t// eslint-disable-next-line no-alert\r\n\t\talert(\r\n\t\t\t`You browser doesn't support native speec, please upgrade or try somewhere else for now.`\r\n\t\t);\r\n\t\treturn;\r\n\t}\r\n\tif (synth.speaking) synth.cancel();\r\n\r\n\t// For some reason this fails in the first time\r\n\tif (!utterance.voice) {\r\n\t\tutterance.voice = synth.getVoices().find(v => v.lang === 'zh-CN');\r\n\t}\r\n\tutterance.text = text;\r\n\tsynth.speak(utterance);\r\n};\r\n\r\n/**\r\n * Imports pinyinJS dictionary and utility once\r\n *\r\n * @see https://github.com/sxei/pinyinjs\r\n */\r\nconst importPinyinJsIfNeeded = async () => {\r\n\tif (!window.pinyin_dict_withtone) {\r\n\t\tconst { data } = await get(PINYIN_JS_DICTIONARY_URL, {\r\n\t\t\theaders: {\r\n\t\t\t\taccept: 'text/js',\r\n\t\t\t},\r\n\t\t});\r\n\t\twindow.pinyin_dict_withtone = data.replace(\r\n\t\t\t/var pinyin_dict_withtone = |\"|;/g,\r\n\t\t\t''\r\n\t\t);\r\n\t}\r\n\tif (!window.pinyinUtil) {\r\n\t\t// await import('./pinyinUtil');\r\n\t\tconst { data } = await get(PINYIN_JS_URL, {\r\n\t\t\theaders: {\r\n\t\t\t\taccept: 'text/js',\r\n\t\t\t},\r\n\t\t});\r\n\r\n\t\t// eslint-disable-next-line no-eval\r\n\t\teval(data);\r\n\t}\r\n};\r\n\r\n/**\r\n * Tries a native speech via Han Trainer Pro w/ a fallback to\r\n * SpeechSynthesisUtterance\r\n *\r\n * @param {String} hanzi Hanzi character to speak.\r\n * @param {String} pinyin Pinyin for the given hanzi.\r\n */\r\nconst trySpeakNative = async (hanzi, pinyin = '') => {\r\n\tif (!hanzi) return;\r\n\r\n\t// If no pinyin was passed in, then we use pinyinjs rather than making\r\n\t// a google-translate api call, this can be cached later so it's ok\r\n\t// to make a rather bigger request\r\n\tlet _pinyin = pinyin;\r\n\tif (!_pinyin) {\r\n\t\tawait importPinyinJsIfNeeded();\r\n\t\t_pinyin = window.pinyinUtil.getPinyin(hanzi);\r\n\t}\r\n\tconst numberedPinyin = markToNumberForHanTrainerPro(_pinyin);\r\n\tconst audioUrl =\r\n\t\tHAN_TRAINER_PRO_PREFIX + numberedPinyin + HAN_TRAINER_PRO_POSTFIX;\r\n\ttry {\r\n\t\tconst audio = new Audio(audioUrl);\r\n\t\tawait audio.play();\r\n\t} catch (e) {\r\n\t\tconsole.warn(\r\n\t\t\t`Failed to fetch native speech, will play default speech. Failed on the following:`,\r\n\t\t\t{\r\n\t\t\t\tpinyin: _pinyin,\r\n\t\t\t\thanzi,\r\n\t\t\t\tnumberedPinyin,\r\n\t\t\t\taudioUrl,\r\n\t\t\t}\r\n\t\t);\r\n\t\tspeak(hanzi);\r\n\t}\r\n};\r\n\r\nexport { speak, trySpeakNative };\r\n","import { useEffect, useRef } from 'react';\r\n\r\n// https://usehooks.com/usePrevious/\r\nconst usePrevious = value => {\r\n\t// The ref object is a generic container whose current property is mutable ...\r\n\t// ... and can hold any value, similar to an instance property on a class\r\n\tconst ref = useRef();\r\n\r\n\t// Store current value in ref\r\n\tuseEffect(() => {\r\n\t\tref.current = value;\r\n\t}, [value]); // Only re-run if value changes\r\n\r\n\t// Return previous value (happens before update in useEffect above)\r\n\treturn ref.current;\r\n};\r\n\r\nexport default usePrevious;\r\n","import { numberOrString, refType } from 'components/types';\r\nimport { bool } from 'prop-types';\r\n\r\nconst propTypes = {\r\n\tinnerRef: refType.isRequired,\r\n\tsize: numberOrString.isRequired,\r\n\triceGrid: bool,\r\n};\r\n\r\nconst defaultProps = {\r\n\triceGrid: true,\r\n};\r\n\r\nexport { propTypes, defaultProps };\r\n","import React, { memo, forwardRef } from 'react';\r\n\r\nconst Plain = memo(forwardRef((props, ref) => <div {...props} ref={ref} />));\r\n\r\nexport default Plain;\r\n","import { bool, string } from 'prop-types';\r\n\r\nimport { numberOrString } from 'components/types';\r\n\r\nconst propTypes = {\r\n\triceGrid: bool,\r\n\tsize: numberOrString,\r\n\tcolor: string,\r\n\topacity: numberOrString,\r\n};\r\nconst defaultProps = {\r\n\triceGrid: true,\r\n\tsize: 150,\r\n\tcolor: '#f50057',\r\n\topacity: 0.4,\r\n};\r\n\r\nexport { propTypes, defaultProps };\r\n","import React, { forwardRef, memo } from 'react';\r\n\r\nimport { propTypes, defaultProps } from './types';\r\n\r\nconst RiceGrid = memo(\r\n\tforwardRef(({ size, color, opacity }, ref) => {\r\n\t\tconst StyledLine = props => (\r\n\t\t\t<line {...props} stroke={color} strokeOpacity={opacity} />\r\n\t\t);\r\n\t\treturn (\r\n\t\t\t<svg\r\n\t\t\t\txmlns=\"http://www.w3.org/2000/svg\"\r\n\t\t\t\twidth={size}\r\n\t\t\t\theight={size}\r\n\t\t\t\tref={ref}\r\n\t\t\t>\r\n\t\t\t\t<StyledLine x1=\"0\" y1=\"0\" x2={size} y2={size} />\r\n\t\t\t\t<StyledLine x1={size} y1=\"0\" x2=\"0\" y2={size} />\r\n\t\t\t\t<StyledLine x1={size / 2} y1=\"0\" x2={size / 2} y2={size} />\r\n\t\t\t\t<StyledLine x1=\"0\" y1={size / 2} x2={size} y2={size / 2} />\r\n\t\t\t</svg>\r\n\t\t);\r\n\t})\r\n);\r\n\r\nRiceGrid.propTypes = propTypes;\r\nRiceGrid.defaultProps = defaultProps;\r\n\r\nexport default RiceGrid;\r\n","import React, { memo, forwardRef } from 'react';\r\n\r\nimport Plain from './Plain';\r\nimport RiceGrid from './RiceGrid';\r\nimport { propTypes, defaultProps } from './types';\r\n\r\nconst Background = memo(\r\n\tforwardRef(({ riceGrid, ...rest }, ref) => {\r\n\t\tconst Bg = (riceGrid && RiceGrid) || Plain;\r\n\t\treturn <Bg {...rest} ref={ref} />;\r\n\t})\r\n);\r\n\r\nBackground.propTypes = propTypes;\r\nBackground.defaultProps = defaultProps;\r\n\r\nexport default Background;\r\n","import React, { memo } from 'react';\r\n\r\nimport { propTypes, defaultProps } from './types';\r\nimport Background from './Background';\r\n\r\nconst Hanzi = memo(({ innerRef, size, riceGrid }) => (\r\n\t<Background size={size} riceGrid={riceGrid} ref={innerRef} />\r\n));\r\n\r\nHanzi.propTypes = propTypes;\r\nHanzi.defaultProps = defaultProps;\r\n\r\nexport default Hanzi;\r\n","import { useTheme } from '@material-ui/core';\r\nimport React, { useEffect, useRef, useState } from 'react';\r\nimport HanziWriter from 'hanzi-writer';\r\n\r\nimport Hanzi from './Hanzi';\r\n\r\nimport {\r\n\tgetDefaultHanziWriterOptions,\r\n\tDEFAULT_OPTIONS,\r\n\tSTART_MODES,\r\n} from './constants';\r\n\r\n/**\r\n * Creates and returns a re-writeable and configurable Hanzi\r\n * @param {String} character Single Hanzi.\r\n * @param {Object} options Options for building the hanzi\r\n * - size, startMode, riceGrid\r\n */\r\nconst useHanzi = (character, options = DEFAULT_OPTIONS) => {\r\n\t/** @type {[Writer, SetStateAction<Writer>]} */\r\n\tconst [bgSize, setBgSize] = useState(options.size || 150);\r\n\tconst [writer, setWriter] = useState(null);\r\n\tconst theme = useTheme();\r\n\r\n\t/** @type {import('react').Ref<HTMLElement>} */\r\n\tconst charRef = useRef();\r\n\r\n\tconst writeHanzi = (newCharacter = character, newOptions = options) => {\r\n\t\tconst _options = {\r\n\t\t\t...DEFAULT_OPTIONS,\r\n\t\t\t...newOptions,\r\n\t\t\thanziWriterOptions: {\r\n\t\t\t\twidth: newOptions.width || newOptions.size,\r\n\t\t\t\theight: newOptions.height || newOptions.size,\r\n\t\t\t\tshowOutline:\r\n\t\t\t\t\t(options || DEFAULT_OPTIONS).startMode !==\r\n\t\t\t\t\tSTART_MODES.QUIZ_CHALLENGE,\r\n\t\t\t\tshowCharacter:\r\n\t\t\t\t\t(options || DEFAULT_OPTIONS).startMode !==\r\n\t\t\t\t\tSTART_MODES.QUIZ_CHALLENGE,\r\n\t\t\t},\r\n\t\t};\r\n\r\n\t\tif (bgSize !== _options.size) setBgSize(_options.size);\r\n\r\n\t\tif (charRef.current) {\r\n\t\t\t// Clear the previous writing first\r\n\t\t\tif (writer) {\r\n\t\t\t\tcharRef.current\r\n\t\t\t\t\t.querySelectorAll((options.riceGrid && 'defs, g') || 'svg')\r\n\t\t\t\t\t.forEach(e => e.remove());\r\n\t\t\t}\r\n\r\n\t\t\t/** @type {Writer} */\r\n\t\t\tconst hanziWriter = HanziWriter.create(\r\n\t\t\t\tcharRef.current,\r\n\t\t\t\tnewCharacter,\r\n\t\t\t\t{\r\n\t\t\t\t\t...getDefaultHanziWriterOptions(theme),\r\n\t\t\t\t\t..._options.hanziWriterOptions,\r\n\t\t\t\t}\r\n\t\t\t);\r\n\r\n\t\t\tconst recursiveQuiz = () => {\r\n\t\t\t\thanziWriter.quiz({\r\n\t\t\t\t\tonComplete: () => {\r\n\t\t\t\t\t\tsetTimeout(() => {\r\n\t\t\t\t\t\t\trecursiveQuiz();\r\n\t\t\t\t\t\t}, 1200);\r\n\t\t\t\t\t},\r\n\t\t\t\t});\r\n\t\t\t};\r\n\r\n\t\t\tsetWriter(hanziWriter);\r\n\t\t\tswitch (newOptions.startMode) {\r\n\t\t\t\tcase START_MODES.LOOP:\r\n\t\t\t\t\thanziWriter.loopCharacterAnimation();\r\n\t\t\t\t\tbreak;\r\n\t\t\t\tcase START_MODES.QUIZ:\r\n\t\t\t\t\trecursiveQuiz();\r\n\t\t\t\t\tbreak;\r\n\t\t\t\tcase START_MODES.QUIZ_CHALLENGE_HIGHLIGHT_ONCE:\r\n\t\t\t\t\trecursiveQuiz();\r\n\t\t\t\t\tbreak;\r\n\t\t\t\tcase START_MODES.QUIZ_CHALLENGE:\r\n\t\t\t\t\trecursiveQuiz();\r\n\t\t\t\t\tbreak;\r\n\t\t\t\tdefault:\r\n\t\t\t\t\t// No Default\r\n\t\t\t\t\t// DRAW_ONCE\r\n\t\t\t\t\tbreak;\r\n\t\t\t}\r\n\t\t}\r\n\t};\r\n\r\n\tuseEffect(() => {\r\n\t\twriteHanzi();\r\n\t\t// eslint-disable-next-line react-hooks/exhaustive-deps\r\n\t}, []);\r\n\r\n\treturn {\r\n\t\thanzi: (\r\n\t\t\t<Hanzi\r\n\t\t\t\tinnerRef={charRef}\r\n\t\t\t\tsize={bgSize}\r\n\t\t\t\triceGrid={options.riceGrid}\r\n\t\t\t/>\r\n\t\t),\r\n\t\trewrite: writeHanzi,\r\n\t\twriter,\r\n\t};\r\n};\r\n\r\nexport default useHanzi;\r\n"],"sourceRoot":""}