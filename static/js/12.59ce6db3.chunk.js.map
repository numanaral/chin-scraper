{"version":3,"sources":["components/ContainerWithCenteredItems/types.js","components/ContainerWithCenteredItems/ContainerWithCenteredItems.js","components/Spacer/StyledWrapper.js","components/Spacer/Spacer.js","components/Spacer/types.js","hooks/useRenderedCount.js","store/firebase/hooks/useSearchQueries.js","utils/chinese.js","api/rest.js","components/Hanzi/constants.js","utils/speech.js","hooks/usePrevious.js","components/Hanzi/types.js","components/Hanzi/Background/Plain.js","components/Hanzi/Background/types.js","components/Hanzi/Background/RiceGrid.js","components/Hanzi/Background/Background.js","components/Hanzi/Hanzi.js","components/Hanzi/useHanzi.js","components/Popover/types.js","components/Popover/Popover.js","containers/Practice/constants.js","containers/Practice/useOnResize.js","components/Switch/Lazy.js","hooks/useSwitches.js","containers/Practice/useSwitchesWithPersistedConfig.js","hooks/useIsFirstMount.js","hooks/useEffectOnUpdate.js","containers/Practice/useHanziWriter.js","hooks/useInput.js","containers/Practice/useInputWithCharacterList.js","containers/Practice/useIndex.js","containers/Practice/Practice.js","routes/pages/Practice.js"],"names":["node","isRequired","bool","StyledGrid","styled","Grid","$horizontal","$vertical","ContainerWithCenteredItems","children","horizontal","vertical","rest","defaultProps","StyledWrapper","span","theme","$direction","$spacing","spacing","Spacer","direction","numberOrString","parseInt","useRenderedCount","name","wrap","count","useRef","c","current","_name","console","log","useSearchQueries","ref","useFirestore","collection","useFirestoreCollectionData","orderBy","add","query","devOrAnalyticsIsDisabled","createdOn","Date","REGEX_STRIP_NON_CHINESE_CHARS","REGEX_STRIP_NON_CHINESE_AND_NON_SET_PUNCTUATION_CHARS","TONE_MAP","ā","á","ǎ","à","ō","ó","ǒ","ò","ē","é","ě","è","ī","í","ǐ","ì","ū","ú","ǔ","ù","ü","ǖ","ǘ","ǚ","ǜ","ń","ň","stripNonChineseChars","text","replace","stripNonChineseAndNonSetPunctionationChars","removeTones","pinyin","match","post","url","body","instance","axios","get","params","put","remove","delete","parse","res","a","data","serverInstance","create","baseURL","process","REACT_APP_SERVER_URI","server","props","getDefaultHanziWriterOptions","width","height","padding","strokeColor","palette","primary","main","radicalColor","success","delayBetweenStrokes","delayBetweenLoops","drawingColor","START_MODES","LOOP","DRAW_ONCE","QUIZ","QUIZ_CHALLENGE","QUIZ_CHALLENGE_HIGHLIGHT_ONCE","DEFAULT_OPTIONS","size","hanziWriterOptions","riceGrid","startMode","HAN_TRAINER_PRO_PREFIX","HAN_TRAINER_PRO_POSTFIX","synth","window","speechSynthesis","utterance","SpeechSynthesisUtterance","pitch","rate","PINYIN_JS_URL","PINYIN_JS_DICTIONARY_URL","markToNumberForHanTrainerPro","speak","speaking","cancel","voice","getVoices","find","v","lang","importPinyinJsIfNeeded","pinyin_dict_withtone","headers","accept","pinyinUtil","eval","trySpeakNative","hanzi","_pinyin","getPinyin","numberedPinyin","audioUrl","audio","Audio","play","warn","usePrevious","value","useEffect","refType","Plain","memo","forwardRef","string","color","opacity","RiceGrid","StyledLine","stroke","strokeOpacity","xmlns","x1","y1","x2","y2","Background","Bg","Hanzi","innerRef","useHanzi","character","options","useState","bgSize","setBgSize","writer","setWriter","useTheme","charRef","writeHanzi","newCharacter","newOptions","_options","showOutline","showCharacter","querySelectorAll","forEach","e","hanziWriter","HanziWriter","recursiveQuiz","quiz","onComplete","setTimeout","loopCharacterAnimation","rewrite","element","objectOf","icon","Wrapper","div","Popover","component","anchorOrigin","transformOrigin","passDownOnCloseProp","tooltip","anchorEl","setAnchorEl","onClose","isPopoverOpen","Boolean","id","undefined","TooltipButton","aria-describedby","onClick","stopPropagation","currentTarget","open","cloneElement","popoverOnClose","PRACTICE_CONFIG","label","shuffle","continuous","challenge","autoPlay","highlightOnceOnChallengeMode","DEFAULT_ICON_SIZE","fontSize","useOnResize","getSmallest","document","clientWidth","clientHeight","setSize","handleResize","_size","addEventListener","removeEventListener","loadable","generateSwitchList","state","onCheck","Object","keys","map","key","Lazy","checked","useSwitches","initialState","cb","switches","setSwitches","useCallback","prev","newValues","switchList","useMemo","reduce","acc","useSwitchesWithPersistedConfig","useLocalStorage","practiceConfig","setPracticeConfig","useIsFirstMount","firstMount","useEffectOnUpdate","effect","dependencies","cleanup","isFirstMount","useHanziWriter","characters","index","writeConfig","useInput","initialValue","input","setInput","onChange","target","useInputWithCharacterList","setCharacters","previousHanzi","getCharacterList","shuffleArray","split","onSubmit","preventDefault","currentHanzi","restart","useIndex","restartDependencyArray","restartCallback","setIndex","isPreviousDisabled","isNextDisabled","length","onPrevious","onNext","onRestart","StyledPaper","Paper","$size","background","level2","StyledTooltipButton","Practice","smAndDown","useMediaQuery","breakpoints","down","pageRef","textFieldProps","getOrder","order","style","_switchList","switchComponent","ind","onSpeak","PageContainer","TextField","variant","type","InputProps","startAdornment","SettingsIcon","endAdornment","InputAdornment","position","disabled","container","alignItems","elevation","Box","textAlign","justify","item","xs","md","fallback","LoadingIndicator","traceId"],"mappings":"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","file":"static/js/12.59ce6db3.chunk.js","sourcesContent":["import { bool, node } from 'prop-types';\r\n\r\nconst propTypes = {\r\n\tchildren: node.isRequired,\r\n\thorizontal: bool,\r\n\tvertical: bool,\r\n};\r\n\r\nconst defaultProps = {\r\n\thorizontal: true,\r\n\tvertical: false,\r\n};\r\n\r\nexport { propTypes, defaultProps };\r\n","import React from 'react';\r\nimport styled from 'styled-components';\r\nimport { Grid } from '@material-ui/core';\r\n\r\nimport { propTypes, defaultProps } from './types';\r\n\r\nconst StyledGrid = styled(Grid)`\r\n\twidth: 100%;\r\n\tdisplay: flex;\r\n\tflex-wrap: wrap;\r\n\t${({ $horizontal, $vertical }) => `\r\n\t\t${$horizontal && 'justify-content: center;'}\r\n\t\t${$vertical && 'height: 100%; align-items: center;'}\r\n\t`}\r\n`;\r\n\r\n/**\r\n * Centered Grid\r\n *\r\n * @component\r\n * @param {import('@material-ui/core').GridProps|import('react').HtmlHTMLAttributes}\r\n */\r\nconst ContainerWithCenteredItems = ({\r\n\tchildren,\r\n\thorizontal,\r\n\tvertical,\r\n\t...rest\r\n}) => (\r\n\t<StyledGrid $horizontal={horizontal} $vertical={vertical} {...rest}>\r\n\t\t{children}\r\n\t</StyledGrid>\r\n);\r\n\r\nContainerWithCenteredItems.propTypes = propTypes;\r\nContainerWithCenteredItems.defaultProps = defaultProps;\r\n\r\nexport default ContainerWithCenteredItems;\r\n","import styled from 'styled-components';\r\n\r\nconst StyledWrapper = styled.span`\r\n\t/* To ensure that the spacer properly exists to space around it */\r\n\twidth: 1px;\r\n\t${({ theme, $direction, $spacing }) => `\r\n\t\tmargin-${$direction}: ${theme.spacing($spacing)}px;\r\n\t`}\r\n`;\r\n\r\nexport default StyledWrapper;\r\n","import React from 'react';\r\nimport StyledWrapper from './StyledWrapper';\r\nimport { defaultProps, propTypes } from './types';\r\n\r\n/**\r\n * Element that adds margin to the given direction based on the\r\n * spacing amount. The amount is passed in to the spacing method\r\n * of Mui. By default 1-unit-spacing = 8px\r\n *\r\n * @example\r\n * ```js\r\n * <Spacer direction=\"right\" spacing=\"5\" />\r\n * ```\r\n *\r\n * @component\r\n */\r\nconst Spacer = ({ direction, spacing }) => (\r\n\t<StyledWrapper $direction={direction} $spacing={parseInt(spacing, 10)} />\r\n);\r\n\r\nSpacer.propTypes = propTypes;\r\nSpacer.defaultProps = defaultProps;\r\n\r\nexport default Spacer;\r\n","import { direction, numberOrString } from 'components/types';\r\n\r\nconst propTypes = {\r\n\t/**\r\n\t * - Which direction do you want to apply margin to\r\n\t */\r\n\tdirection: direction.isRequired,\r\n\t/**\r\n\t * - The amount is passed in to the spacing method of Mui.\r\n\t * - By default 1-unit-spacing = 8px\r\n\t */\r\n\tspacing: numberOrString,\r\n};\r\nconst defaultProps = {\r\n\tspacing: 1,\r\n};\r\n\r\nexport { propTypes, defaultProps };\r\n","import { useRef } from 'react';\r\n\r\n/**\r\n * Counts the time a component was rendered\r\n *\r\n * @param {String} name - Name of the component\r\n * @param {Boolean} wrap - Should wrap with < and />?\r\n */\r\nconst useRenderedCount = (name, wrap = true) => {\r\n\tconst count = useRef(1);\r\n\tconst { current: c } = count;\r\n\tconst _name = (wrap && `<${name} /> `) || `\"${name}\"`;\r\n\tconsole.log(`Rendered ${_name} ${c} time${(c > 1 && 's') || ''}`);\r\n\tcount.current += 1;\r\n};\r\n\r\nexport default useRenderedCount;\r\n","import { useFirestore, useFirestoreCollectionData } from 'reactfire';\r\n\r\nimport { devOrAnalyticsIsDisabled } from '../utils';\r\n\r\nconst useSearchQueries = () => {\r\n\tconst ref = useFirestore().collection('searchQueries');\r\n\tconst collection = useFirestoreCollectionData(ref.orderBy('createdOn'));\r\n\r\n\tconst add = query => {\r\n\t\tif (devOrAnalyticsIsDisabled) return;\r\n\r\n\t\tref.add({\r\n\t\t\tquery,\r\n\t\t\tcreatedOn: new Date(),\r\n\t\t});\r\n\t};\r\n\r\n\treturn { collection, add };\r\n};\r\n\r\nexport default useSearchQueries;\r\n","const REGEX_CHINESE = /\\p{Script=Han}/u;\r\nconst REGEX_PINYIN = /<td class=\"hanzi5-article-hanzi-info-td2\">(.*)<\\/td>/;\r\nconst REGEX_STRIP_NON_CHINESE_CHARS = /[^\\p{Script=Han}]+/gu;\r\nconst REGEX_STRIP_NON_CHINESE_AND_NON_SET_PUNCTUATION_CHARS = /[^\\p{Script=Han},.?!，、。？！]+/gu;\r\n\r\n/** @see https://github.com/sxei/pinyinjs/blob/3f0013841ba62a6d1af38e50839ea196b27369cb/pinyinUtil.js#L16 */\r\nconst TONE_MAP = {\r\n\tā: 'a',\r\n\tá: 'a',\r\n\tǎ: 'a',\r\n\tà: 'a',\r\n\tō: 'o',\r\n\tó: 'o',\r\n\tǒ: 'o',\r\n\tò: 'o',\r\n\tē: 'e',\r\n\té: 'e',\r\n\tě: 'e',\r\n\tè: 'e',\r\n\tī: 'i',\r\n\tí: 'i',\r\n\tǐ: 'i',\r\n\tì: 'i',\r\n\tū: 'u',\r\n\tú: 'u',\r\n\tǔ: 'u',\r\n\tù: 'u',\r\n\tü: 'v',\r\n\tǖ: 'v',\r\n\tǘ: 'v',\r\n\tǚ: 'v',\r\n\tǜ: 'v',\r\n\tń: 'n',\r\n\tň: 'n',\r\n\t'': 'm',\r\n};\r\n\r\nconst isChinese = text => REGEX_CHINESE.test(text);\r\nconst stripNonChineseChars = text =>\r\n\ttext.replace(REGEX_STRIP_NON_CHINESE_CHARS, '');\r\nconst stripNonChineseAndNonSetPunctionationChars = text =>\r\n\ttext.replace(REGEX_STRIP_NON_CHINESE_AND_NON_SET_PUNCTUATION_CHARS, '');\r\nconst removeTones = pinyin =>\r\n\tpinyin.replace(/[āáǎàōóǒòēéěèīíǐìūúǔùüǖǘǚǜńň]/g, match => TONE_MAP[match]);\r\n\r\nexport {\r\n\tREGEX_CHINESE,\r\n\tREGEX_PINYIN,\r\n\tREGEX_STRIP_NON_CHINESE_CHARS,\r\n\tREGEX_STRIP_NON_CHINESE_AND_NON_SET_PUNCTUATION_CHARS,\r\n\tisChinese,\r\n\tstripNonChineseChars,\r\n\tstripNonChineseAndNonSetPunctionationChars,\r\n\tremoveTones,\r\n};\r\n","import axios from 'axios';\r\n\r\nconst post = (url, body = {}, instance = axios) => instance.post(url, body);\r\n\r\nconst get = (url, params = {}, instance = axios) => {\r\n\treturn instance.get(url, {\r\n\t\tparams,\r\n\t});\r\n};\r\n\r\nconst put = (url, body, instance = axios) => instance.put(url, body);\r\n\r\nconst remove = (url, instance = axios) => instance.delete(url);\r\n\r\n// https://github.com/axios/axios#response-schema\r\nconst parse = async res => {\r\n\tconst { data } = await res;\r\n\treturn data;\r\n};\r\n\r\n// Set config defaults when creating the instance\r\nconst serverInstance = axios.create({\r\n\tbaseURL: process.env.REACT_APP_SERVER_URI,\r\n});\r\n\r\nconst server = {\r\n\tpost: (...props) => post(...props, serverInstance),\r\n\tget: (...props) => get(...props, serverInstance),\r\n\tput: (...props) => put(...props, serverInstance),\r\n\tdelete: (...props) => remove(...props, serverInstance),\r\n};\r\n\r\nexport { post, get, put, remove as delete, parse, server };\r\n","const getDefaultHanziWriterOptions = theme => ({\r\n\twidth: 150,\r\n\theight: 150,\r\n\tpadding: 5,\r\n\tstrokeColor: theme.palette.primary.main,\r\n\tradicalColor: theme.palette.success.main,\r\n\t// strokeAnimationSpeed: 1,\r\n\tdelayBetweenStrokes: 200,\r\n\tdelayBetweenLoops: 500,\r\n\tdrawingColor: theme.palette.text.primary,\r\n\t// drawingWidth: 25,\r\n});\r\n\r\nconst START_MODES = {\r\n\tLOOP: 'loop',\r\n\tDRAW_ONCE: 'drawOnce',\r\n\tQUIZ: 'quiz',\r\n\tQUIZ_CHALLENGE: 'quizChallenge',\r\n\tQUIZ_CHALLENGE_HIGHLIGHT_ONCE: 'quizChallengeHighlightOnce',\r\n};\r\n\r\nconst DEFAULT_OPTIONS = {\r\n\tsize: 150,\r\n\thanziWriterOptions: {},\r\n\triceGrid: true,\r\n\tstartMode: START_MODES.LOOP,\r\n};\r\n\r\nexport { getDefaultHanziWriterOptions, START_MODES, DEFAULT_OPTIONS };\r\n","// #region CONSTANTS\r\n\r\nimport { get } from 'api/rest';\r\n\r\n/** @see https://github.com/sxei/pinyinjs/blob/3f0013841ba62a6d1af38e50839ea196b27369cb/pinyinUtil.js#L16 */\r\nconst TONE_MAP = {\r\n\tā: 'a1',\r\n\tá: 'a2',\r\n\tǎ: 'a3',\r\n\tà: 'a4',\r\n\tō: 'o1',\r\n\tó: 'o2',\r\n\tǒ: 'o3',\r\n\tò: 'o4',\r\n\tē: 'e1',\r\n\té: 'e2',\r\n\tě: 'e3',\r\n\tè: 'e4',\r\n\tī: 'i1',\r\n\tí: 'i2',\r\n\tǐ: 'i3',\r\n\tì: 'i4',\r\n\tū: 'u1',\r\n\tú: 'u2',\r\n\tǔ: 'u3',\r\n\tù: 'u4',\r\n\tü: 'v0',\r\n\tǖ: 'v1',\r\n\tǘ: 'v2',\r\n\tǚ: 'v3',\r\n\tǜ: 'v4',\r\n\tń: 'n2',\r\n\tň: 'n3',\r\n\t'': 'm2',\r\n};\r\n\r\nconst HAN_TRAINER_PRO_PREFIX = `https://www.hantrainerpro.de/resources/pronunciations/`;\r\nconst HAN_TRAINER_PRO_POSTFIX = '.mp3';\r\n\r\n// Don't recreate these on each speak\r\nconst synth = window.speechSynthesis;\r\nconst utterance = new SpeechSynthesisUtterance();\r\nutterance.pitch = 1;\r\nutterance.rate = 0.8;\r\n\r\nconst PINYIN_JS_URL = `https://cdn.jsdelivr.net/gh/sxei/pinyinjs/pinyinUtil.js`;\r\nconst PINYIN_JS_DICTIONARY_URL = `https://cdn.jsdelivr.net/gh/sxei/pinyinjs/dict/pinyin_dict_withtone.js`;\r\n\r\n// #endregion\r\n\r\n/**\r\n * HanTrainerPro uses direct mark to tone conversion, so we need to\r\n * parse single tone marks to their respective numbered tones.\r\n * - As an example, for hǎo:\r\n * \t- We would normally want hao3\r\n * \t\t- @see https://hantrainerpro.de/resources/pronunciations/hao3.mp3 (Error)\r\n * \t- But the api works with ha3o\r\n * \t\t- @see https://hantrainerpro.de/resources/pronunciations/ha3o.mp3 (Working)\r\n *\r\n * @see https://github.com/sxei/pinyinjs/blob/3f0013841ba62a6d1af38e50839ea196b27369cb/pinyinUtil.js#L260 (Algorithm)\r\n *\r\n * @example\r\n * markToNumberForHanTrainerPro(hǎo);\r\n * // returns ha3o\r\n *\r\n * @param {String} pinyin Pinyin to parse\r\n */\r\nconst markToNumberForHanTrainerPro = pinyin =>\r\n\tpinyin.replace(/[āáǎàōóǒòēéěèīíǐìūúǔùüǖǘǚǜńň]/g, match => TONE_MAP[match]);\r\n\r\n/**\r\n * Speaks the given word using SpeechSynthesisUtterance\r\n *\r\n * @param {String} text Hanzi to speak.\r\n */\r\nconst speak = text => {\r\n\tif (!text) return;\r\n\tif (synth.speaking) synth.cancel();\r\n\r\n\t// For some reason this fails in the first time\r\n\tif (!utterance.voice) {\r\n\t\tutterance.voice = synth.getVoices().find(v => v.lang === 'zh-CN');\r\n\t}\r\n\tutterance.text = text;\r\n\tsynth.speak(utterance);\r\n};\r\n\r\n/**\r\n * Imports pinyinJS dictionary and utility once\r\n *\r\n * @see https://github.com/sxei/pinyinjs\r\n */\r\nconst importPinyinJsIfNeeded = async () => {\r\n\tif (!window.pinyin_dict_withtone) {\r\n\t\tconst { data } = await get(PINYIN_JS_DICTIONARY_URL, {\r\n\t\t\theaders: {\r\n\t\t\t\taccept: 'text/js',\r\n\t\t\t},\r\n\t\t});\r\n\t\twindow.pinyin_dict_withtone = data.replace(\r\n\t\t\t/var pinyin_dict_withtone = |\"|;/g,\r\n\t\t\t''\r\n\t\t);\r\n\t}\r\n\tif (!window.pinyinUtil) {\r\n\t\t// await import('./pinyinUtil');\r\n\t\tconst { data } = await get(PINYIN_JS_URL, {\r\n\t\t\theaders: {\r\n\t\t\t\taccept: 'text/js',\r\n\t\t\t},\r\n\t\t});\r\n\r\n\t\t// eslint-disable-next-line no-eval\r\n\t\teval(data);\r\n\t}\r\n};\r\n\r\n/**\r\n * Tries a native speech via Han Trainer Pro w/ a fallback to\r\n * SpeechSynthesisUtterance\r\n *\r\n * @param {String} hanzi Hanzi character to speak.\r\n * @param {String} pinyin Pinyin for the given hanzi.\r\n */\r\nconst trySpeakNative = async (hanzi, pinyin = '') => {\r\n\tif (!hanzi) return;\r\n\r\n\t// If no pinyin was passed in, then we use pinyinjs rather than making\r\n\t// a google-translate api call, this can be cached later so it's ok\r\n\t// to make a rather bigger request\r\n\tlet _pinyin = pinyin;\r\n\tif (!_pinyin) {\r\n\t\tawait importPinyinJsIfNeeded();\r\n\t\t_pinyin = window.pinyinUtil.getPinyin(hanzi);\r\n\t}\r\n\tconst numberedPinyin = markToNumberForHanTrainerPro(_pinyin);\r\n\tconst audioUrl =\r\n\t\tHAN_TRAINER_PRO_PREFIX + numberedPinyin + HAN_TRAINER_PRO_POSTFIX;\r\n\ttry {\r\n\t\tconst audio = new Audio(audioUrl);\r\n\t\tawait audio.play();\r\n\t} catch (e) {\r\n\t\tconsole.warn(\r\n\t\t\t`Failed to fetch native speech, will play default speech. Failed on the following:`,\r\n\t\t\t{\r\n\t\t\t\tpinyin: _pinyin,\r\n\t\t\t\thanzi,\r\n\t\t\t\tnumberedPinyin,\r\n\t\t\t\taudioUrl,\r\n\t\t\t}\r\n\t\t);\r\n\t\tspeak(hanzi);\r\n\t}\r\n};\r\n\r\nexport { speak, trySpeakNative };\r\n","import { useEffect, useRef } from 'react';\r\n\r\n// https://usehooks.com/usePrevious/\r\nconst usePrevious = value => {\r\n\t// The ref object is a generic container whose current property is mutable ...\r\n\t// ... and can hold any value, similar to an instance property on a class\r\n\tconst ref = useRef();\r\n\r\n\t// Store current value in ref\r\n\tuseEffect(() => {\r\n\t\tref.current = value;\r\n\t}, [value]); // Only re-run if value changes\r\n\r\n\t// Return previous value (happens before update in useEffect above)\r\n\treturn ref.current;\r\n};\r\n\r\nexport default usePrevious;\r\n","import { numberOrString, refType } from 'components/types';\r\nimport { bool } from 'prop-types';\r\n\r\nconst propTypes = {\r\n\tinnerRef: refType.isRequired,\r\n\tsize: numberOrString.isRequired,\r\n\triceGrid: bool,\r\n};\r\n\r\nconst defaultProps = {\r\n\triceGrid: true,\r\n};\r\n\r\nexport { propTypes, defaultProps };\r\n","import React, { memo, forwardRef } from 'react';\r\n\r\nconst Plain = memo(forwardRef((props, ref) => <div {...props} ref={ref} />));\r\n\r\nexport default Plain;\r\n","import { bool, string } from 'prop-types';\r\n\r\nimport { numberOrString } from 'components/types';\r\n\r\nconst propTypes = {\r\n\triceGrid: bool,\r\n\tsize: numberOrString,\r\n\tcolor: string,\r\n\topacity: numberOrString,\r\n};\r\nconst defaultProps = {\r\n\triceGrid: true,\r\n\tsize: 150,\r\n\tcolor: '#f50057',\r\n\topacity: 0.4,\r\n};\r\n\r\nexport { propTypes, defaultProps };\r\n","import useRenderedCount from 'hooks/useRenderedCount';\r\nimport React, { forwardRef, memo } from 'react';\r\n\r\nimport { propTypes, defaultProps } from './types';\r\n\r\nconst RiceGrid = memo(\r\n\tforwardRef(({ size, color, opacity }, ref) => {\r\n\t\tuseRenderedCount('Stroked');\r\n\t\tconst StyledLine = props => (\r\n\t\t\t<line {...props} stroke={color} strokeOpacity={opacity} />\r\n\t\t);\r\n\t\treturn (\r\n\t\t\t<svg\r\n\t\t\t\txmlns=\"http://www.w3.org/2000/svg\"\r\n\t\t\t\twidth={size}\r\n\t\t\t\theight={size}\r\n\t\t\t\tref={ref}\r\n\t\t\t>\r\n\t\t\t\t<StyledLine x1=\"0\" y1=\"0\" x2={size} y2={size} />\r\n\t\t\t\t<StyledLine x1={size} y1=\"0\" x2=\"0\" y2={size} />\r\n\t\t\t\t<StyledLine x1={size / 2} y1=\"0\" x2={size / 2} y2={size} />\r\n\t\t\t\t<StyledLine x1=\"0\" y1={size / 2} x2={size} y2={size / 2} />\r\n\t\t\t</svg>\r\n\t\t);\r\n\t})\r\n);\r\n\r\nRiceGrid.propTypes = propTypes;\r\nRiceGrid.defaultProps = defaultProps;\r\n\r\nexport default RiceGrid;\r\n","import React, { memo, forwardRef } from 'react';\r\n\r\nimport Plain from './Plain';\r\nimport RiceGrid from './RiceGrid';\r\nimport { propTypes, defaultProps } from './types';\r\n\r\nconst Background = memo(\r\n\tforwardRef(({ riceGrid, ...rest }, ref) => {\r\n\t\tconst Bg = (riceGrid && RiceGrid) || Plain;\r\n\t\treturn <Bg {...rest} ref={ref} />;\r\n\t})\r\n);\r\n\r\nBackground.propTypes = propTypes;\r\nBackground.defaultProps = defaultProps;\r\n\r\nexport default Background;\r\n","import React, { memo } from 'react';\r\n\r\nimport useRenderedCount from 'hooks/useRenderedCount';\r\nimport { propTypes, defaultProps } from './types';\r\nimport Background from './Background';\r\n\r\nconst Hanzi = memo(({ innerRef, size, riceGrid }) => {\r\n\tuseRenderedCount('Hanzi');\r\n\r\n\treturn <Background size={size} riceGrid={riceGrid} ref={innerRef} />;\r\n});\r\n\r\nHanzi.propTypes = propTypes;\r\nHanzi.defaultProps = defaultProps;\r\n\r\nexport default Hanzi;\r\n","import { useTheme } from '@material-ui/core';\r\nimport React, { useEffect, useRef, useState } from 'react';\r\nimport HanziWriter from 'hanzi-writer';\r\n\r\nimport Hanzi from './Hanzi';\r\n\r\nimport {\r\n\tgetDefaultHanziWriterOptions,\r\n\tDEFAULT_OPTIONS,\r\n\tSTART_MODES,\r\n} from './constants';\r\n\r\n/**\r\n * Creates and returns a re-writeable and configurable Hanzi\r\n * @param {String} character Single Hanzi.\r\n * @param {Object} options Options for building the hanzi\r\n * - size, startMode, riceGrid\r\n */\r\nconst useHanzi = (character, options = DEFAULT_OPTIONS) => {\r\n\t/** @type {[Writer, SetStateAction<Writer>]} */\r\n\tconst [bgSize, setBgSize] = useState(options.size || 150);\r\n\tconst [writer, setWriter] = useState(null);\r\n\tconst theme = useTheme();\r\n\r\n\t/** @type {import('react').Ref<HTMLElement>} */\r\n\tconst charRef = useRef();\r\n\r\n\tconst writeHanzi = (newCharacter = character, newOptions = options) => {\r\n\t\tconst _options = {\r\n\t\t\t...DEFAULT_OPTIONS,\r\n\t\t\t...newOptions,\r\n\t\t\thanziWriterOptions: {\r\n\t\t\t\twidth: newOptions.width || newOptions.size,\r\n\t\t\t\theight: newOptions.height || newOptions.size,\r\n\t\t\t\tshowOutline:\r\n\t\t\t\t\t(options || DEFAULT_OPTIONS).startMode !==\r\n\t\t\t\t\tSTART_MODES.QUIZ_CHALLENGE,\r\n\t\t\t\tshowCharacter:\r\n\t\t\t\t\t(options || DEFAULT_OPTIONS).startMode !==\r\n\t\t\t\t\tSTART_MODES.QUIZ_CHALLENGE,\r\n\t\t\t},\r\n\t\t};\r\n\r\n\t\tif (bgSize !== _options.size) setBgSize(_options.size);\r\n\r\n\t\tif (charRef.current) {\r\n\t\t\t// Clear the previous writing first\r\n\t\t\tif (writer) {\r\n\t\t\t\tcharRef.current\r\n\t\t\t\t\t.querySelectorAll((options.riceGrid && 'defs, g') || 'svg')\r\n\t\t\t\t\t.forEach(e => e.remove());\r\n\t\t\t}\r\n\r\n\t\t\t/** @type {Writer} */\r\n\t\t\tconst hanziWriter = HanziWriter.create(\r\n\t\t\t\tcharRef.current,\r\n\t\t\t\tnewCharacter,\r\n\t\t\t\t{\r\n\t\t\t\t\t...getDefaultHanziWriterOptions(theme),\r\n\t\t\t\t\t..._options.hanziWriterOptions,\r\n\t\t\t\t}\r\n\t\t\t);\r\n\r\n\t\t\tconst recursiveQuiz = () => {\r\n\t\t\t\thanziWriter.quiz({\r\n\t\t\t\t\tonComplete: () => {\r\n\t\t\t\t\t\tsetTimeout(() => {\r\n\t\t\t\t\t\t\trecursiveQuiz();\r\n\t\t\t\t\t\t}, 1200);\r\n\t\t\t\t\t},\r\n\t\t\t\t});\r\n\t\t\t};\r\n\r\n\t\t\tsetWriter(hanziWriter);\r\n\t\t\tswitch (newOptions.startMode) {\r\n\t\t\t\tcase START_MODES.LOOP:\r\n\t\t\t\t\thanziWriter.loopCharacterAnimation();\r\n\t\t\t\t\tbreak;\r\n\t\t\t\tcase START_MODES.QUIZ:\r\n\t\t\t\t\trecursiveQuiz();\r\n\t\t\t\t\tbreak;\r\n\t\t\t\tcase START_MODES.QUIZ_CHALLENGE_HIGHLIGHT_ONCE:\r\n\t\t\t\t\trecursiveQuiz();\r\n\t\t\t\t\tbreak;\r\n\t\t\t\tcase START_MODES.QUIZ_CHALLENGE:\r\n\t\t\t\t\trecursiveQuiz();\r\n\t\t\t\t\tbreak;\r\n\t\t\t\tdefault:\r\n\t\t\t\t\t// No Default\r\n\t\t\t\t\t// DRAW_ONCE\r\n\t\t\t\t\tbreak;\r\n\t\t\t}\r\n\t\t}\r\n\t};\r\n\r\n\tuseEffect(() => {\r\n\t\twriteHanzi();\r\n\t\t// eslint-disable-next-line react-hooks/exhaustive-deps\r\n\t}, []);\r\n\r\n\treturn {\r\n\t\thanzi: (\r\n\t\t\t<Hanzi\r\n\t\t\t\tinnerRef={charRef}\r\n\t\t\t\tsize={bgSize}\r\n\t\t\t\triceGrid={options.riceGrid}\r\n\t\t\t/>\r\n\t\t),\r\n\t\trewrite: writeHanzi,\r\n\t\twriter,\r\n\t};\r\n};\r\n\r\nexport default useHanzi;\r\n","import { element, bool, objectOf, string } from 'prop-types';\r\n\r\nimport { icon } from 'components/types';\r\n\r\nconst propTypes = {\r\n\tcomponent: element.isRequired,\r\n\tpassDownOnCloseProp: bool,\r\n\tanchorOrigin: objectOf(string),\r\n\ttransformOrigin: objectOf(string),\r\n\ttooltip: string,\r\n\ttext: string,\r\n\ticon,\r\n};\r\n\r\nconst defaultProps = {\r\n\tpassDownOnCloseProp: false,\r\n\tanchorOrigin: {\r\n\t\tvertical: 'bottom',\r\n\t\thorizontal: 'center',\r\n\t},\r\n\ttransformOrigin: {\r\n\t\tvertical: 'top',\r\n\t\thorizontal: 'center',\r\n\t},\r\n\ttooltip: '',\r\n\ttext: null,\r\n\ticon: null,\r\n};\r\n\r\nexport { propTypes, defaultProps };\r\n","import React, { cloneElement, useState } from 'react';\r\nimport { Popover as MuiPopover } from '@material-ui/core';\r\nimport TooltipButton from 'components/TooltipButton';\r\nimport styled from 'styled-components';\r\n\r\nimport { propTypes, defaultProps } from './types';\r\n\r\nconst Wrapper = styled.div`\r\n\t&.MuiPopover-root {\r\n\t\tmargin: auto;\r\n\t\t// width: '3.5rem',\r\n\t\theight: 48px;\r\n\t\twidth: 48px;\r\n\r\n\t\tdisplay: inline-flex;\r\n\t\tposition: relative;\r\n\t\talign-items: center;\r\n\t\tvertical-align: middle;\r\n\t\t-moz-appearance: none;\r\n\t\tjustify-content: center;\r\n\t}\r\n\r\n\t& button {\r\n\t\tmargin: auto;\r\n\t}\r\n`;\r\n\r\nconst Popover = ({\r\n\tcomponent,\r\n\tanchorOrigin,\r\n\ttransformOrigin,\r\n\tpassDownOnCloseProp,\r\n\ttooltip,\r\n\ttext,\r\n\ticon,\r\n\t...rest\r\n}) => {\r\n\tconst [anchorEl, setAnchorEl] = useState(null);\r\n\r\n\tconst onClick = e => {\r\n\t\te.stopPropagation();\r\n\t\tsetAnchorEl(e.currentTarget);\r\n\t};\r\n\tconst onClose = () => {\r\n\t\tsetAnchorEl(null);\r\n\t};\r\n\r\n\tconst isPopoverOpen = Boolean(anchorEl);\r\n\tconst id = isPopoverOpen ? 'simple-popover' : undefined;\r\n\r\n\treturn (\r\n\t\t<Wrapper>\r\n\t\t\t<TooltipButton\r\n\t\t\t\taria-describedby={id}\r\n\t\t\t\ttooltip={tooltip}\r\n\t\t\t\tonClick={onClick}\r\n\t\t\t\ttext={text}\r\n\t\t\t\ticon={icon}\r\n\t\t\t/>\r\n\t\t\t<MuiPopover\r\n\t\t\t\tid={id}\r\n\t\t\t\topen={isPopoverOpen}\r\n\t\t\t\tanchorEl={anchorEl}\r\n\t\t\t\tonClose={onClose}\r\n\t\t\t\tanchorOrigin={anchorOrigin}\r\n\t\t\t\ttransformOrigin={transformOrigin}\r\n\t\t\t\t{...rest}\r\n\t\t\t>\r\n\t\t\t\t{(passDownOnCloseProp &&\r\n\t\t\t\t\tcloneElement(component, { popoverOnClose: onClose })) ||\r\n\t\t\t\t\tcomponent}\r\n\t\t\t</MuiPopover>\r\n\t\t</Wrapper>\r\n\t);\r\n};\r\n\r\nPopover.propTypes = propTypes;\r\nPopover.defaultProps = defaultProps;\r\n\r\nexport default Popover;\r\n","const PRACTICE_CONFIG = {\r\n\triceGrid: {\r\n\t\tlabel: 'Rice Grid (米)',\r\n\t\tvalue: true,\r\n\t},\r\n\tshuffle: {\r\n\t\tlabel: 'Shuffle',\r\n\t\tvalue: true,\r\n\t},\r\n\tcontinuous: {\r\n\t\tlabel: 'Continuous',\r\n\t\tvalue: true,\r\n\t},\r\n\tchallenge: {\r\n\t\tlabel: 'Challenge Mode',\r\n\t\tvalue: false,\r\n\t},\r\n\tautoPlay: {\r\n\t\tlabel: 'Autoplay sound',\r\n\t\tvalue: true,\r\n\t},\r\n\thighlightOnceOnChallengeMode: {\r\n\t\tlabel: 'Highlight once in Challenge Mode',\r\n\t\tvalue: true,\r\n\t},\r\n};\r\nconst MAX_SIZE = 350;\r\nconst PRACTICE_CONFIG_LOCAL_STORAGE_KEY = 'practiceConfig';\r\n\r\nconst DEFAULT_ICON_SIZE = {\r\n\tfontSize: 'large',\r\n};\r\n\r\nexport {\r\n\tPRACTICE_CONFIG,\r\n\tMAX_SIZE,\r\n\tPRACTICE_CONFIG_LOCAL_STORAGE_KEY,\r\n\tDEFAULT_ICON_SIZE,\r\n};\r\n","import { useEffect, useRef, useState } from 'react';\r\nimport { useTheme } from '@material-ui/core';\r\n\r\nimport { getSmallest } from 'utils/object';\r\nimport { MAX_SIZE } from './constants';\r\n\r\nconst useOnResize = () => {\r\n\tconst ref = useRef();\r\n\tconst { spacing } = useTheme();\r\n\tconst [size, setSize] = useState(\r\n\t\tgetSmallest(\r\n\t\t\twindow.document.body.clientWidth,\r\n\t\t\twindow.document.body.clientHeight,\r\n\t\t\tMAX_SIZE\r\n\t\t)\r\n\t);\r\n\r\n\tuseEffect(() => {\r\n\t\tconst handleResize = () => {\r\n\t\t\tif (ref.current) {\r\n\t\t\t\tconst _size =\r\n\t\t\t\t\tgetSmallest(\r\n\t\t\t\t\t\tref.current.clientWidth,\r\n\t\t\t\t\t\tref.current.clientHeight,\r\n\t\t\t\t\t\tMAX_SIZE\r\n\t\t\t\t\t) - spacing(5);\r\n\t\t\t\tsetSize(_size);\r\n\t\t\t}\r\n\t\t};\r\n\t\thandleResize();\r\n\t\twindow.addEventListener('resize', handleResize);\r\n\t\treturn () => {\r\n\t\t\twindow.removeEventListener('resize', handleResize);\r\n\t\t};\r\n\t}, [spacing]);\r\n\r\n\treturn {\r\n\t\tref,\r\n\t\tsize,\r\n\t};\r\n};\r\n\r\nexport default useOnResize;\r\n","import loadable from 'utils/loadable';\r\n\r\nexport default loadable(() => import('./index'), 'small');\r\n","import React, { useCallback, useMemo, useState } from 'react';\r\n\r\nimport LazySwitch from 'components/Switch/Lazy';\r\n\r\nconst generateSwitchList = (state, onCheck) =>\r\n\tObject.keys(state).map(key => {\r\n\t\tconst { value, label } = state[key];\r\n\t\treturn (\r\n\t\t\t<LazySwitch\r\n\t\t\t\tkey={key}\r\n\t\t\t\tname={key}\r\n\t\t\t\tlabel={label}\r\n\t\t\t\tchecked={value}\r\n\t\t\t\tonCheck={onCheck}\r\n\t\t\t/>\r\n\t\t);\r\n\t});\r\n\r\nconst useSwitches = (initialState, cb = null) => {\r\n\tconst [switches, setSwitches] = useState(initialState);\r\n\r\n\tconst onCheck = useCallback(\r\n\t\t(key, value) => {\r\n\t\t\tsetSwitches(prev => {\r\n\t\t\t\tconst newValues = {\r\n\t\t\t\t\t...prev,\r\n\t\t\t\t\t[key]: {\r\n\t\t\t\t\t\t...prev[key],\r\n\t\t\t\t\t\tvalue,\r\n\t\t\t\t\t},\r\n\t\t\t\t};\r\n\t\t\t\tcb?.(newValues);\r\n\r\n\t\t\t\treturn newValues;\r\n\t\t\t});\r\n\t\t},\r\n\t\t[cb]\r\n\t);\r\n\r\n\tconst switchList = useMemo(() => generateSwitchList(switches, onCheck), [\r\n\t\tswitches,\r\n\t\tonCheck,\r\n\t]);\r\n\r\n\treturn {\r\n\t\tswitches: Object.keys(switches).reduce(\r\n\t\t\t(acc, key) => ({\r\n\t\t\t\t...acc,\r\n\t\t\t\t[key]: switches[key].value,\r\n\t\t\t}),\r\n\t\t\t{}\r\n\t\t),\r\n\t\tsetSwitches,\r\n\t\tonCheck,\r\n\t\tswitchList,\r\n\t};\r\n};\r\n\r\nexport default useSwitches;\r\n","import useLocalStorage from 'hooks/useLocalStorage';\r\nimport useSwitches from 'hooks/useSwitches';\r\nimport {\r\n\tPRACTICE_CONFIG,\r\n\tPRACTICE_CONFIG_LOCAL_STORAGE_KEY,\r\n} from './constants';\r\n\r\nconst useSwitchesWithPersistedConfig = () => {\r\n\tconst [practiceConfig, setPracticeConfig] = useLocalStorage(\r\n\t\tPRACTICE_CONFIG_LOCAL_STORAGE_KEY,\r\n\t\tPRACTICE_CONFIG\r\n\t);\r\n\r\n\treturn useSwitches(practiceConfig, setPracticeConfig);\r\n};\r\n\r\nexport default useSwitchesWithPersistedConfig;\r\n","import { useRef } from 'react';\r\n\r\nconst useIsFirstMount = () => {\r\n\tconst firstMount = useRef(true);\r\n\r\n\tif (firstMount.current) {\r\n\t\tfirstMount.current = false;\r\n\r\n\t\treturn true;\r\n\t}\r\n\r\n\treturn firstMount.current;\r\n};\r\n\r\nexport default useIsFirstMount;\r\n","import { useEffect } from 'react';\r\n\r\nimport useIsFirstMount from './useIsFirstMount';\r\n\r\nconst useEffectOnUpdate = (effect, dependencies, cleanup) => {\r\n\tconst isFirstMount = useIsFirstMount();\r\n\r\n\tuseEffect(() => {\r\n\t\tif (!isFirstMount) effect();\r\n\t\treturn cleanup;\r\n\r\n\t\t// eslint-disable-next-line react-hooks/exhaustive-deps\r\n\t}, dependencies);\r\n};\r\n\r\nexport default useEffectOnUpdate;\r\n","import { useEffect } from 'react';\r\n\r\nimport useHanzi from 'components/Hanzi/useHanzi';\r\nimport { START_MODES } from 'components/Hanzi/constants';\r\nimport useEffectOnUpdate from 'hooks/useEffectOnUpdate';\r\n\r\nconst useHanziWriter = ({ size, characters, index, switches }) => {\r\n\tconst { riceGrid, challenge, highlightOnceOnChallengeMode } = switches;\r\n\r\n\tconst writeConfig = {\r\n\t\tsize,\r\n\t\triceGrid,\r\n\t\tstartMode:\r\n\t\t\t(highlightOnceOnChallengeMode &&\r\n\t\t\t\tSTART_MODES.QUIZ_CHALLENGE_HIGHLIGHT_ONCE) ||\r\n\t\t\t(challenge && START_MODES.QUIZ_CHALLENGE) ||\r\n\t\t\tSTART_MODES.QUIZ,\r\n\t};\r\n\r\n\tconst { hanzi, rewrite, writer } = useHanzi(characters[index], writeConfig);\r\n\r\n\tconst rewriteHanzi = () => {\r\n\t\trewrite(characters[index], writeConfig);\r\n\t};\r\n\r\n\tuseEffectOnUpdate(() => {\r\n\t\trewriteHanzi();\r\n\t}, [riceGrid, size, index, characters]);\r\n\r\n\tuseEffect(() => {\r\n\t\twriter?.[`${(challenge && 'hide') || 'show'}Outline`]();\r\n\t}, [writer, challenge]);\r\n\r\n\treturn {\r\n\t\thanzi,\r\n\t};\r\n};\r\n\r\nexport default useHanziWriter;\r\n","import { useState } from 'react';\r\n\r\nconst useInput = (initialValue = '') => {\r\n\tconst [input, setInput] = useState(initialValue);\r\n\r\n\tconst onChange = e => setInput(e.target.value);\r\n\r\n\treturn {\r\n\t\tinput,\r\n\t\tsetInput,\r\n\t\tonChange,\r\n\t};\r\n};\r\n\r\nexport default useInput;\r\n","import { useEffect, useState } from 'react';\r\n\r\nimport useInput from 'hooks/useInput';\r\nimport { shuffleArray } from 'utils/object';\r\nimport { stripNonChineseChars } from 'utils/chinese';\r\nimport usePrevious from 'hooks/usePrevious';\r\nimport useSearchQueries from 'store/firebase/hooks/useSearchQueries';\r\n\r\nconst useInputWithCharacterList = (initialValue, shuffle, label) => {\r\n\tconst { add } = useSearchQueries();\r\n\tconst { input, setInput, onChange, ...rest } = useInput(initialValue);\r\n\tconst [characters, setCharacters] = useState([]);\r\n\tconst previousHanzi = usePrevious(input);\r\n\r\n\tconst getCharacterList = (text = input) =>\r\n\t\t(shuffle && shuffleArray(text)) || text.split('');\r\n\r\n\tconst restart = () => {\r\n\t\tsetCharacters(v => getCharacterList((shuffle && v) || input));\r\n\t};\r\n\r\n\tconst onSubmit = async e => {\r\n\t\te.preventDefault();\r\n\r\n\t\tconst currentHanzi = stripNonChineseChars(input);\r\n\t\t// Filter out non-hanzi characters from the input\r\n\t\tif (stripNonChineseChars(previousHanzi) === currentHanzi) {\r\n\t\t\tif (previousHanzi !== input) setInput(currentHanzi);\r\n\t\t\tif (!currentHanzi) setCharacters([]);\r\n\t\t\treturn;\r\n\t\t}\r\n\r\n\t\tif (currentHanzi) {\r\n\t\t\tadd(currentHanzi);\r\n\t\t\tsetInput(currentHanzi);\r\n\t\t\tsetCharacters(getCharacterList(currentHanzi));\r\n\t\t\treturn;\r\n\t\t}\r\n\r\n\t\t// If all non-hanzi characters, reset to empty\r\n\t\tsetCharacters([]);\r\n\t\tsetInput('');\r\n\t};\r\n\r\n\tuseEffect(() => {\r\n\t\tsetCharacters(getCharacterList());\r\n\t\t// eslint-disable-next-line react-hooks/exhaustive-deps\r\n\t}, []);\r\n\r\n\treturn {\r\n\t\tcharacters,\r\n\t\tinput,\r\n\t\trestart,\r\n\t\tonChange,\r\n\t\tonSubmit,\r\n\t\tlabel,\r\n\t\t...rest,\r\n\t};\r\n};\r\n\r\nexport default useInputWithCharacterList;\r\n","import { useState } from 'react';\r\n\r\nimport useEffectOnUpdate from 'hooks/useEffectOnUpdate';\r\n\r\nconst useIndex = (input, restartDependencyArray, restartCallback = null) => {\r\n\tconst [index, setIndex] = useState(0);\r\n\tconst isPreviousDisabled = index === 0;\r\n\tconst isNextDisabled = index + 1 === input.length;\r\n\tconst onPrevious = () => setIndex(v => v - 1);\r\n\tconst onNext = () => setIndex(v => v + 1);\r\n\tconst onRestart = () => {\r\n\t\tsetIndex(0);\r\n\t\trestartCallback?.();\r\n\t};\r\n\r\n\tuseEffectOnUpdate(() => {\r\n\t\tonRestart();\r\n\t}, restartDependencyArray);\r\n\r\n\treturn {\r\n\t\tindex,\r\n\t\tisPreviousDisabled,\r\n\t\tisNextDisabled,\r\n\t\tonPrevious,\r\n\t\tonNext,\r\n\t\tonRestart,\r\n\t};\r\n};\r\n\r\nexport default useIndex;\r\n","import React, { useEffect } from 'react';\r\nimport {\r\n\tBox,\r\n\tGrid,\r\n\tInputAdornment,\r\n\tPaper,\r\n\tTextField,\r\n\tuseMediaQuery,\r\n} from '@material-ui/core';\r\nimport styled from 'styled-components';\r\n\r\nimport ContainerWithCenteredItems from 'components/ContainerWithCenteredItems';\r\nimport useRenderedCount from 'hooks/useRenderedCount';\r\nimport PageContainer from 'routes/PageContainer';\r\nimport TooltipButton from 'components/TooltipButton';\r\nimport {\r\n\tPreviousIcon,\r\n\tNextIcon,\r\n\tSubmitIcon,\r\n\tReplayIcon,\r\n\tSettingsIcon,\r\n\tSpeakIcon,\r\n} from 'icons';\r\nimport Spacer from 'components/Spacer';\r\nimport Popover from 'components/Popover';\r\nimport { trySpeakNative } from 'utils/speech';\r\nimport useOnResize from './useOnResize';\r\nimport useSwitchesWithPersistedConfig from './useSwitchesWithPersistedConfig';\r\nimport useHanziWriter from './useHanziWriter';\r\nimport useInputWithCharacterList from './useInputWithCharacterList';\r\nimport useIndex from './useIndex';\r\nimport { DEFAULT_ICON_SIZE } from './constants';\r\n\r\nconst StyledPaper = styled(Paper)`\r\n\t${({ theme, $size }) => `\r\n\t\tposition: relative;\r\n\t\tbackground-color: ${theme.palette.background.level2};\r\n\t\tpadding: ${theme.spacing(2)}px;\r\n\t\t${($size && `width: ${$size}px`) || ''}\r\n\t`}\r\n`;\r\n\r\nconst StyledTooltipButton = styled(TooltipButton)`\r\n\tposition: absolute;\r\n\ttop: 0;\r\n\tright: 0;\r\n`;\r\n\r\nconst Practice = () => {\r\n\tuseRenderedCount('Practice');\r\n\tconst smAndDown = useMediaQuery(theme => theme.breakpoints.down('sm'));\r\n\tconst { ref: pageRef, size } = useOnResize();\r\n\tconst { switches, switchList } = useSwitchesWithPersistedConfig();\r\n\tconst {\r\n\t\tcharacters,\r\n\t\trestart,\r\n\t\tinput,\r\n\t\tonSubmit,\r\n\t\t...textFieldProps\r\n\t} = useInputWithCharacterList('', switches.shuffle, 'Enter hanzi(s)');\r\n\tconst {\r\n\t\tindex,\r\n\t\tisPreviousDisabled,\r\n\t\tisNextDisabled,\r\n\t\tonPrevious,\r\n\t\tonNext,\r\n\t\tonRestart,\r\n\t} = useIndex(input, [switches.shuffle], restart);\r\n\tconst { hanzi } = useHanziWriter({\r\n\t\tsize,\r\n\t\tcharacters,\r\n\t\tindex,\r\n\t\tswitches,\r\n\t});\r\n\r\n\tconst getOrder = order => ({\r\n\t\tstyle: {\r\n\t\t\torder,\r\n\t\t},\r\n\t});\r\n\r\n\tconst _switchList = switchList.map((switchComponent, ind) => (\r\n\t\t<div key={ind}>\r\n\t\t\t{switchComponent}\r\n\t\t\t<br />\r\n\t\t</div>\r\n\t));\r\n\r\n\tconst onSpeak = () => trySpeakNative(characters[index]);\r\n\r\n\tuseEffect(() => {\r\n\t\tif (switches.autoPlay) onSpeak();\r\n\t\t// eslint-disable-next-line react-hooks/exhaustive-deps\r\n\t}, [index]);\r\n\r\n\treturn (\r\n\t\t<PageContainer innerRef={pageRef}>\r\n\t\t\t{/* INPUT BOX */}\r\n\t\t\t<form onSubmit={onSubmit}>\r\n\t\t\t\t<TextField\r\n\t\t\t\t\tvalue={input}\r\n\t\t\t\t\tvariant=\"outlined\"\r\n\t\t\t\t\ttype=\"search\"\r\n\t\t\t\t\tInputProps={{\r\n\t\t\t\t\t\t...(smAndDown && {\r\n\t\t\t\t\t\t\tstartAdornment: (\r\n\t\t\t\t\t\t\t\t<Popover\r\n\t\t\t\t\t\t\t\t\ticon={SettingsIcon}\r\n\t\t\t\t\t\t\t\t\tcomponent={\r\n\t\t\t\t\t\t\t\t\t\t<StyledPaper $size={350}>\r\n\t\t\t\t\t\t\t\t\t\t\t{_switchList}\r\n\t\t\t\t\t\t\t\t\t\t</StyledPaper>\r\n\t\t\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t\t/>\r\n\t\t\t\t\t\t\t),\r\n\t\t\t\t\t\t}),\r\n\t\t\t\t\t\tendAdornment: (\r\n\t\t\t\t\t\t\t<InputAdornment position=\"start\">\r\n\t\t\t\t\t\t\t\t<TooltipButton\r\n\t\t\t\t\t\t\t\t\ttooltip=\"Search\"\r\n\t\t\t\t\t\t\t\t\tdisabled={!input}\r\n\t\t\t\t\t\t\t\t\tcolor=\"primary\"\r\n\t\t\t\t\t\t\t\t\ticon={<SubmitIcon fontSize=\"small\" />}\r\n\t\t\t\t\t\t\t\t\ttype=\"submit\"\r\n\t\t\t\t\t\t\t\t/>\r\n\t\t\t\t\t\t\t</InputAdornment>\r\n\t\t\t\t\t\t),\r\n\t\t\t\t\t}}\r\n\t\t\t\t\t{...textFieldProps}\r\n\t\t\t\t/>\r\n\t\t\t</form>\r\n\t\t\t{/* CONFIGURATION */}\r\n\t\t\t{!smAndDown && (\r\n\t\t\t\t<ContainerWithCenteredItems container alignItems=\"center\">\r\n\t\t\t\t\t<Paper elevation={3}>\r\n\t\t\t\t\t\t<Box width={350} padding={2} textAlign=\"left\">\r\n\t\t\t\t\t\t\t{_switchList}\r\n\t\t\t\t\t\t</Box>\r\n\t\t\t\t\t</Paper>\r\n\t\t\t\t</ContainerWithCenteredItems>\r\n\t\t\t)}\r\n\t\t\t{/* HANZI */}\r\n\t\t\t{!!characters.length && (\r\n\t\t\t\t<ContainerWithCenteredItems\r\n\t\t\t\t\tcontainer\r\n\t\t\t\t\talignItems=\"center\"\r\n\t\t\t\t\tjustify=\"space-between\"\r\n\t\t\t\t>\r\n\t\t\t\t\t{/* LEFT BUTTON */}\r\n\t\t\t\t\t<div {...getOrder(2)}>\r\n\t\t\t\t\t\t<TooltipButton\r\n\t\t\t\t\t\t\ttooltip=\"Previous\"\r\n\t\t\t\t\t\t\ticon={<PreviousIcon {...DEFAULT_ICON_SIZE} />}\r\n\t\t\t\t\t\t\tonClick={onPrevious}\r\n\t\t\t\t\t\t\tdisabled={isPreviousDisabled}\r\n\t\t\t\t\t\t/>\r\n\t\t\t\t\t\t<Spacer order=\"1\" direction=\"right\" spacing=\"10\" />\r\n\t\t\t\t\t</div>\r\n\t\t\t\t\t{/* DRAWING */}\r\n\t\t\t\t\t<Grid\r\n\t\t\t\t\t\t{...(smAndDown && {\r\n\t\t\t\t\t\t\tcontainer: true,\r\n\t\t\t\t\t\t\tjustify: 'center',\r\n\t\t\t\t\t\t})}\r\n\t\t\t\t\t\titem\r\n\t\t\t\t\t\txs={12}\r\n\t\t\t\t\t\tmd=\"auto\"\r\n\t\t\t\t\t\t{...getOrder((smAndDown && 1) || 3)}\r\n\t\t\t\t\t>\r\n\t\t\t\t\t\t<StyledPaper elevation={3}>\r\n\t\t\t\t\t\t\t<StyledTooltipButton\r\n\t\t\t\t\t\t\t\ttooltip=\"Speak\"\r\n\t\t\t\t\t\t\t\tonClick={onSpeak}\r\n\t\t\t\t\t\t\t\tdisabled={!input}\r\n\t\t\t\t\t\t\t\ticon={<SpeakIcon {...DEFAULT_ICON_SIZE} />}\r\n\t\t\t\t\t\t\t/>\r\n\t\t\t\t\t\t\t{hanzi}\r\n\t\t\t\t\t\t</StyledPaper>\r\n\t\t\t\t\t</Grid>\r\n\t\t\t\t\t{/* RIGHT BUTTON */}\r\n\t\t\t\t\t<div {...getOrder(4)}>\r\n\t\t\t\t\t\t<Spacer order=\"2\" direction=\"left\" spacing=\"10\" />\r\n\t\t\t\t\t\t{((!isNextDisabled || !switches.continuous) && (\r\n\t\t\t\t\t\t\t<TooltipButton\r\n\t\t\t\t\t\t\t\ttooltip=\"Next\"\r\n\t\t\t\t\t\t\t\ticon={<NextIcon {...DEFAULT_ICON_SIZE} />}\r\n\t\t\t\t\t\t\t\tonClick={onNext}\r\n\t\t\t\t\t\t\t\tdisabled={isNextDisabled}\r\n\t\t\t\t\t\t\t/>\r\n\t\t\t\t\t\t)) || (\r\n\t\t\t\t\t\t\t<TooltipButton\r\n\t\t\t\t\t\t\t\ttooltip=\"Restart\"\r\n\t\t\t\t\t\t\t\ticon={<ReplayIcon {...DEFAULT_ICON_SIZE} />}\r\n\t\t\t\t\t\t\t\tonClick={onRestart}\r\n\t\t\t\t\t\t\t/>\r\n\t\t\t\t\t\t)}\r\n\t\t\t\t\t</div>\r\n\t\t\t\t</ContainerWithCenteredItems>\r\n\t\t\t)}\r\n\t\t</PageContainer>\r\n\t);\r\n};\r\n\r\nexport default Practice;\r\n","import React from 'react';\r\nimport { SuspenseWithPerf } from 'reactfire';\r\n\r\nimport PracticeContainer from 'containers/Practice';\r\nimport LoadingIndicator from 'components/LoadingIndicator';\r\n\r\nconst Practice = () => (\r\n\t<SuspenseWithPerf fallback={<LoadingIndicator />} traceId=\"load-practice\">\r\n\t\t<PracticeContainer />\r\n\t</SuspenseWithPerf>\r\n);\r\n\r\nexport default Practice;\r\n"],"sourceRoot":""}